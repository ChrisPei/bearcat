!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.bearcat=a()}}(function(){var define,module,exports;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){a("./lib/util/requireUtil"),b.exports=a("./lib/bearcat")},{"./lib/bearcat":20,"./lib/util/requireUtil":42}],2:[function(a,b){var c=a("./pointcut"),d=function(){this.pointcut=null,this.beanName=null,this.runtime=null,this.advice=null,this.order=null,this.bean=null};d.prototype.setPointcut=function(a){if(a){var b=new c;b.setExpression(a),this.pointcut=b}},d.prototype.getPointcut=function(){return this.pointcut},d.prototype.setAdvice=function(a){this.advice=a},d.prototype.getAdvice=function(){return this.advice},d.prototype.setBeanName=function(a){this.beanName=a},d.prototype.getBeanName=function(){return this.beanName},d.prototype.setBean=function(a){this.bean=a},d.prototype.getBean=function(){return this.bean},d.prototype.setOrder=function(a){this.order=a},d.prototype.getOrder=function(){return this.order},d.prototype.setRuntime=function(a){this.runtime=a},d.prototype.isRuntime=function(){return this.runtime},d.prototype.parse=function(){this.pointcut.parse()},b.exports=d},{"./pointcut":9}],3:[function(a,b){var c=function(){this.advisors=[],this.beanName=null,this.beanDefinition=null,this.bean=null};c.prototype.addAdvisor=function(a){this.advisors.push(a)},c.prototype.getAdvisors=function(){return this.advisors},c.prototype.setBeanDefinition=function(a){this.beanDefinition=a},c.prototype.getBeanDefinition=function(){return this.beanDefinition},c.prototype.setBeanName=function(a){this.beanName=a},c.prototype.getBeanName=function(){return this.beanName},c.prototype.setBean=function(a){this.bean=a},c.prototype.getBean=function(){return this.bean},b.exports=c},{}],4:[function(a,b){var c=a("../framework/proxyFactory"),d=a("../targetSource"),e=a("../../util/aopUtil"),f=a("../../util/utils"),g=function(){this.beanFactory=null};g.prototype.before=function(a){return a},g.prototype.after=function(a,b){return this.wrapIfNecessary(a,b)},g.prototype.setBeanFactory=function(a){this.beanFactory=a},g.prototype.getBeanFactory=function(){return this.beanFactory},g.prototype.wrapIfNecessary=function(a,b){var c=this.beanFactory.getBeanDefinition(b);if(!c.needProxy())return a;if(c.isAspect())return a;var e=this.getAdvisorsForBean(a,b);if(f.checkArray(e)&&e.length){var g=this.createProxy(a,b,e,new d(b,a));return g}return a},g.prototype.createProxy=function(a,b,d,f){var g=new c;g.setBeanFactory(this.getBeanFactory()),g.setTarget(f);var h=e.getMethodsFromObject(a);g.setInterfaces(h);for(var i=0;i<d.length;i++)g.addAdvisor(d[i]);return g.getProxy()},g.prototype.getAdvisorsForBean=function(a,b){return this.findEligibleAdvisors(a,b)},g.prototype.findEligibleAdvisors=function(a,b){var c=this.findCandidateAdvisors(a,b);return this.findAdvisorsThatCanApply(a,b,c)},g.prototype.findCandidateAdvisors=function(a,b){for(var c=this.beanFactory.getAspects(),d=[],e=0;e<c.length;e++){var f=c[e],b=f.getBeanName(),g=this.beanFactory.getBean(b);f.setBean(g);for(var h=f.getAdvisors(),i=0;i<h.length;i++){var j=h[i];j.setBean(g),d.push(j)}}return d},g.prototype.findAdvisorsThatCanApply=function(a,b,c){for(var d=[],f=0;f<c.length;f++){var g=c[f];this.canApply(g,a,b)&&d.push(g)}return d=e.sortAdvisorsByOrder(d)},g.prototype.canApply=function(a,b,c){for(var d=e.getMethodsFromObject(b),f=a.getPointcut(),g=0;g<d.length;g++){var h=c+"."+d[g];if(f.match(h))return!0}return!1},b.exports=g},{"../../util/aopUtil":35,"../../util/utils":44,"../framework/proxyFactory":8,"../targetSource":10}],5:[function(a,b){var c=a("../../util/utils"),d=function(){this.advisors=[],this.interfaces=[],this.methodCache={},this.beanFactory=null,this.targetSource=null,this.advisorChainFactory=null};d.prototype.setTarget=function(a){this.setTargetSource(a)},d.prototype.setTargetSource=function(a){this.targetSource=a},d.prototype.getTargetSource=function(){return this.targetSource},d.prototype.setInterfaces=function(a){for(var b=0;b<a.length;b++)this.addInterface(a[b])},d.prototype.addInterface=function(a){this.interfaces.push(a)},d.prototype.getInterfaces=function(){return this.interfaces},d.prototype.getAdvisors=function(){return this.advisors},d.prototype.addAdvisor=function(a){this.advisors.push(a)},d.prototype.getBeanFactory=function(){return this.beanFactory},d.prototype.setBeanFactory=function(a){this.beanFactory=a},d.prototype.getInterceptionAdvice=function(a,b,c){var d=a+"_"+c,e=this.methodCache[d];return e||(e=this.doGetInterceptionAdvice(a,b,c),this.methodCache[d]=e),e},d.prototype.doGetInterceptionAdvice=function(a,b,d){for(var e=[],f=this.getAdvisors(),g=b+"."+a,h=0;h<f.length;h++){var i=f[h],j=i.getPointcut();j.getAdviceType()===d&&j.match(g)&&e.push(i)}return e.sort(c.compareByOrder),e},b.exports=d},{"../../util/utils":44}],6:[function(a,b){var c=a("pomelo-logger").getLogger("bearcat","DynamicAopProxy"),d=a("../../util/constant"),e=a("../../util/utils"),f=function(a){this.advised=a,this.dyInit()};f.prototype.dyInit=function(){if(!this.advised)return void c.error("DynamicAopProxy init error no advised");for(var a=this.advised.getInterfaces(),b=this,d=0;d<a.length;d++)!function(a){return h(a)?void c.error("init error proxy method interface %j the same as DynamicAopProxy, rename this name to another.",a):void(b[a]=function(){return arguments=Array.prototype.slice.apply(arguments),b.dyInvoke(a,arguments)})}(a[d])},f.prototype.dyInvoke=function(a,b){var c=this,f=b.pop(),g=!1;e.checkFunction(f)||(b.push(f),f=function(){},g=!0);var h=this.advised.getTargetSource(),i=h.getBeanName(),j=h.getTarget(),k=d.AOP_ADVICE_BEFORE,l=this.advised.getInterceptionAdvice(a,i,k);k=d.AOP_ADVICE_AROUND;var m=this.advised.getInterceptionAdvice(a,i,k),n=!1;e.checkArray(m)&&m.length&&(n=!0),k=d.AOP_ADVICE_AFTER;var o=this.advised.getInterceptionAdvice(a,i,k),p=!1;return e.checkArray(o)&&o.length&&(p=!0),this.doInvokeAdvisorsBefore(a,b,l,function(d){if(d)return f(d);if(!n){var e=function(){arguments=Array.prototype.slice.apply(arguments),f.apply(null,arguments),c.doInvokeAdvisorsAfter(a,arguments,o,function(){})};if(g){var h=j[a].apply(j,b);return p&&c.doInvokeAdvisorsAfter(a,h,o,function(){}),h}return b.push(e),j[a].apply(j,b)}c.doInvokeAdvisorsAround(j,a,b,m,function(){arguments=Array.prototype.slice.apply(arguments),f.apply(null,arguments),c.doInvokeAdvisorsAfter(a,arguments,o,function(){})})})},f.prototype.doInvokeAdvisorsBefore=function(a,b,c,d){var f=0;if(b=Array.prototype.slice.apply(b),!c||!e.checkArray(c)||!c.length)return d();var g=function(a){if(a||f>=c.length)return d(a);var e=c[f++],h=e.getAdvice(),i=e.getBean(),j=function(a){g(a)};e.isRuntime()?(b.push(j),i[h].apply(i,b)):i[h](j)};g()},f.prototype.doInvokeAdvisorsAround=function(a,b,c,d,e){var f=d[0],g=f.getAdvice(),h=f.getBean();f.isRuntime()?(c.unshift(b),c.unshift(a),c.push(e),h[g].apply(h,c)):h[g](a,b,e)},f.prototype.doInvokeAdvisorsAfter=function(a,b,c,d){var f=0;if(!c||!e.checkArray(c)||!c.length)return d();e.checkArray(b)||(b=[b]);var g=function(a){if(a||f>=c.length)return d(a);var e=c[f++],h=e.getAdvice(),i=e.getBean(),j=function(a){g(a)};b.push(j),i[h].apply(i,b)};g()};var g=["dyInit","dyInvoke","doInvokeAdvisorsBefore","doInvokeAdvisorsAround","doInvokeAdvisorsAfter"],h=function(a){for(var b=0;b<g.length;b++)if(a===g[b])return!0;return!1};b.exports=f},{"../../util/constant":37,"../../util/utils":44,"pomelo-logger":57}],7:[function(a,b){var c=a("pomelo-logger").getLogger("bearcat","DynamicMetaProxy"),d=a("../../util/utils"),e=function(){this.args=null,this.target=null,this.beanFactory=null,this.beanDefinition=null};e.prototype._dyInit=function(){var a=this.beanDefinition;if(!a)return void c.error("init error no beanDefinition.");var b=this,e=a.getFunc();if(d.checkFunction(e)){var f=e.prototype;for(interface in f)d.checkFunction(f[interface])&&!function(a){return g(a)?void c.error("init error proxy method interface %j the same as DynamicMetaProxy, rename this name to another.",a):void(b[a]=function(){return b._dyInvoke(a,arguments)})}(interface)}},e.prototype._dyInvoke=function(a,b){var e=this._getBean();return d.checkFunction(e[a])?e[a].apply(e,b):void c.error("invoke error no such method %s in the target bean",a)},e.prototype._getBean=function(){var a=this.args,b=this.beanFactory;return this.target||(this.target=b.getBean.apply(b,a)),this.target};var f=["_dyInit","_dyInvoke","_getBean"],g=function(a){for(var b=0;b<f.length;b++)if(a===f[b])return!0;return!1};b.exports=e},{"../../util/utils":44,"pomelo-logger":57}],8:[function(a,b){var c=a("../../util/requireUtil"),d=a("./dynamicAopProxy"),e=a("./advisedSupport"),f=a("../../util/utils"),g=c.requireUtil(),h=function(a,b){this.beanFactory=null,e.call(this),a&&this.setTarget(a),f.checkArray(b)&&this.setInterfaces(b)};g.inherits(h,e),h.prototype.getProxy=function(){var a=(this.getBeanFactory(),new d(this));return a},b.exports=h},{"../../util/requireUtil":42,"../../util/utils":44,"./advisedSupport":5,"./dynamicAopProxy":6}],9:[function(a,b){var c=a("../util/utils"),d=function(){this.expression=null,this.adviceType=null,this.targetExpression=null};d.prototype.setExpression=function(a){this.expression=a},d.prototype.getExpression=function(){return this.expression},d.prototype.setAdviceType=function(a){this.adviceType=a},d.prototype.getAdviceType=function(){return this.adviceType},d.prototype.setTargetExpression=function(a){this.targetExpression=new RegExp(a)},d.prototype.getTargetExpression=function(){return this.targetExpression},d.prototype.parse=function(){var a=this.getExpression();if(a){var b=a.split(":");c.checkArray(b)&&2===b.length&&(this.setAdviceType(b[0]),this.setTargetExpression(b[1]))}},d.prototype.match=function(a){var b=this.getTargetExpression();return a.match(b)},b.exports=d},{"../util/utils":44}],10:[function(a,b){var c=function(a,b){this.beanName=a,this.target=b};c.prototype.setBeanName=function(a){this.beanName=a},c.prototype.getBeanName=function(){return this.beanName},c.prototype.setTarget=function(a){this.target=a},c.prototype.getTarget=function(){return this.target},c.prototype.releaseTarget=function(){},b.exports=c},{}],11:[function(a,b){var c=a("pomelo-logger").getLogger("bearcat","BeanFactory"),d=a("../aop/framework/dynamicMetaProxy"),e=a("./singletonBeanFactory"),f=a("../model/modelConstraint"),g=a("../model/modelDefinition"),h=a("./support/beanDefinition"),i=a("../util/validatorUtil"),j=a("../model/modelFilter"),k=a("../model/modelProxy"),l=a("../util/modelUtil"),m=a("../util/constant"),n=a("../util/beanUtil"),o=a("../util/aopUtil"),p=(a("../aop/aspect"),a("../util/utils")),q=function(){this.aspects=[],this.modelMap={},this.initCbMap={},this.beanCurMap={},this.constraints={},this.tableModelMap={},this.beanFunctions={},this.beanDefinitions={},this.beanPostProcessors=[],this.singletonBeanFactory=new e(this)};q.prototype.getBean=function(a){if(this.beanCurMap[a])return void c.error("circle reference beanName "+a+" is in creating");this.beanCurMap[a]=!0;var b=this.doGetBean.apply(this,arguments);return delete this.beanCurMap[a],b},q.prototype.getBeanProxy=function(){return this.doGetBeanProxy.apply(this,arguments)},q.prototype.getModelProxy=function(a){return this.doGetModelProxy(a)},q.prototype.getConstraint=function(a){return this.doGetConstraint(a)},q.prototype.doGetBean=function(a){var b=this.getBeanDefinition(a);return b?b.isAbstract()?(c.warn("abstract bean can not get bean instance, you can use bearcat.getFunction to get constructor function of the bean"),this.getBeanFunction(a)):(b.hasParentBean()&&(b=this.setParentBean(a)),b.isSingleton()?this.singletonBeanFactory.getSingleton.apply(this.singletonBeanFactory,arguments):b.isPrototype()?this.createBean.apply(this,arguments):void 0):(c.error("BeanFactory beanDefinition null for %j",a),null)},q.prototype.doGetBeanProxy=function(a){var b=this.getBeanDefinition(a);if(!b)return c.error("BeanFactory beanDefinition null for %j",a),null;var e=new d;return e.beanDefinition=b,e.beanFactory=this,e.args=arguments,e._dyInit(),e},q.prototype.doGetModelProxy=function(a){var b=this.getModelDefinition(a);if(!b)return c.error("BeanFactory modelDefinition null for %j",a),null;var d=b.getId(),e=this.getBeanDefinition(d);if(!e)return c.error("BeanFactory beanDefinition null for %j",a),null;var f=new j;f.setModelDefinition(b);var g=new k,h=this.getBean(d),i=b.getFields();for(var l in i){var n=i[l],o=n.getDefault(),q=n.getType();p.isNotNull(o)&&(q===m.TYPE_NUMBER&&(o=parseInt(o)),h[l]=o)}return f.setModel(h),g.model=h,g.beanFactory=this,g.modelFilter=f,g.beanDefinition=e,g.modelDefinition=b,g._modelInit(),g},q.prototype.doGetConstraint=function(a){var b=this.getConstraintDefinition(a);if(!b)return c.error("BeanFactory constraintDefinition null for %j",a),null;var d=b.getId();return this.getBean(d)},q.prototype.createBean=function(a){var b=this.doCreateBean.apply(this,arguments);return b=this.initBean(b,a,this.getInitCb(a))},q.prototype.doCreateBean=function(a){var b=this.getBeanDefinition(a);if(!b)return null;if(b.hasFactoryBean())return this.getBeanFromFactoryBean.apply(this,arguments);var c=b.getArgsOn(),d=b.getPropsOn(),e=this.getBeanFunction(a);if(!e)return null;var f=this.getDependsBeanValues(c,arguments),g=this.getDependsApplyArgs(f),h=Object.create(e.prototype);if(e.apply(h,g),f=this.getDependsBeanValues(d),p.checkArray(f))for(var i=0;i<f.length;i++){var j=f[i],k=j.getName();j.getDependType()===m.DEPEND_TYPE_BEAN?h[k]=j.getBean():j.getDependType()===m.DEPEND_TYPE_VALUE&&(h[k]=j.getValue())}return h},q.prototype.initBean=function(a,b,c){var d=this.getBeanDefinition(b);if(d)return a=this.applyBeanPostProcessorsBeforeInitialization(a,b),this.invokeInitMethods(a,b,c),a=this.applyBeanPostProcessorsAfterInitialization(a,b)},q.prototype.invokeInitMethods=function(a,b,c){var d=this.getBeanDefinition(b);if(d&&d.hasInitMethod()){var e=d.getInitMethodName(),f=a[e];p.checkFunction(f)&&f.call(a,c)}},q.prototype.getBeanFromFactoryBean=function(a){var b=this.getBeanDefinition(a),c=b.getFactoryBeanName(),d=b.getFactoryMethodName(),e=b.getFactoryArgsOn(),f=this.getBean(c);if(!f)return null;var g=f[d],h=this.getDependsBeanValues(e,arguments),i=this.getDependsApplyArgs(h),j=g.apply(f,i);return j},q.prototype.getDependsBeanValues=function(a,b){var c=[];if(!p.checkArray(a))return c;for(var d=1,e=0;e<a.length;e++){var f=a[e],g=f.getRef();if(f.getDependType()===m.DEPEND_TYPE_BEAN){var h=this.getBean(g);h&&f.setBean(h)}if(f.getDependType()===m.DEPEND_TYPE_VAR){var i=b[d++];f.setValue(i)}c.push(f)}return c},q.prototype.getDependsApplyArgs=function(a){var b=[];if(!p.checkArray(a))return b;for(var d=0;d<a.length;d++){var e=a[d];e.getDependType()===m.DEPEND_TYPE_BEAN?b.push(e.getBean()):e.getDependType()===m.DEPEND_TYPE_VALUE?b.push(e.getValue()):e.getDependType()===m.DEPEND_TYPE_VAR?b.push(e.getValueOnce()):c.error("getDependsApplyArgs depends args type error %j",e)}return b},q.prototype.setParentBean=function(a){var b=this.getBeanDefinition(a);if(!b)return null;var c=b.getParentName(),d=this.getBeanDefinition(c),e=this.getBeanFunction(a),f=this.getBeanFunction(c);if(f){var g=f.prototype;for(var h in g)e.prototype[h]||(e.prototype[h]=g[h])}return d&&(b.setParentBean(d),b.setArgsOn(d.getArgs()),b.setPropsOn(d.getProps()),b.setFactoryArgsOn(d.getFactoryArgs())),b},q.prototype.registerBeans=function(a){for(var b in a)this.registerBean(b,a[b])},q.prototype.registerBean=function(a,b){var d=b.func,e=i.metaValidator(b);if(e!==!0)return void c.error("registryBean %j metaObject %j validate error %s",a,b,e.stack);var f=b.mid;f&&this.registerModel(a,f,b);var g=b.cid;g&&this.registerConstraint(a,g,b),d&&p.checkFunction(d)&&!this.getBeanFunction(a)&&this.setBeanFunction(a,d);var j=b.order,k=b.parent,l=b.init,q=b.destroy,r=b.factoryBean,s=b.factoryMethod,t=b.scope||m.SCOPE_DEFAULT,u=b.args||m.ARGS_DEFAULT,v=b.props||m.PROPS_DEFAULT,w=b.factoryArgs||m.ARGS_DEFAULT,x=b.async||m.ASYNC_INIT_DEFAULT,y=b.lazy||m.LAZY_INIT_DEFAULT,z=b["abstract"]||m.ABSTRACT_DEFAULT,A=b.proxy;p.isNotNull(A)||(A=m.PROXY_DEFAULT);var B=b.aop,C=null;if(C=this.getBeanDefinition(a),C||(C=new h),f&&(t=m.SCOPE_PROTOTYPE),C.setFunc(d),C.setOrder(j),C.setScope(t),C.setProxy(A),C.setBeanName(a),C.setLazyInit(y),C.setAbstract(z),C.setAsyncInit(x),C.setParentName(k),C.setInitMethodName(l),C.setFactoryBeanName(r),C.setFactoryMethodName(s),C.setDestroyMethodName(q),C.setArgsOn(n.buildBeanWrapper(u)),C.setPropsOn(n.buildBeanWrapper(v)),C.setFactoryArgsOn(n.buildBeanWrapper(w)),B&&p.checkArray(B)){var D=o.buildAspect(B,C);this.aspects.push(D),C.setAspect(!0)}this.beanDefinitions[a]=C},q.prototype.registerModel=function(a,b,c){var d=null;d=this.getModelDefinition(b),d||(d=new g);var e=c.table,f=c.prefix,h=c.attributes,i=l.buildModelAttribute(h,this);d.setId(a),d.setMid(b),d.setTable(e),d.setPrefix(f),d.setFields(i.fields),d.setBalance(i.balance),d.setRefFields(i.refFields),d.setOneToMany(i.oneToMany),p.isNotNull(e)&&this.setTableModelMap(e,d),this.modelMap[b]=d},q.prototype.registerConstraint=function(a,b,c){var d=null;d=this.getConstraintDefinition(b),d||(d=new f);var e=(c.message,c.constraint);d.setId(a),d.setCid(b),d.setConstraint(e),this.constraints[b]=d},q.prototype.preInstantiateSingletons=function(a){var b=n.sortBeanDefinitions(this.beanDefinitions,this),c=this,d=0,e=function(f){if(f||d>=b.length)return a(f);var g=b[d++],h=g.getBeanName();if(g.isAsyncInit())if(c.singletonBeanFactory.containsSingleton(h))c.getBean(h),e();else{var i=function(){e()};c.setInitCb(h,i),c.getBean(h)}else{var i=function(){};c.setInitCb(h,i),c.getBean(h),e()}};e()},q.prototype.addBeanPostProcessor=function(a){this.beanPostProcessors.push(a)},q.prototype.getBeanPostProcessors=function(){return this.beanPostProcessors},q.prototype.applyBeanPostProcessorsBeforeInitialization=function(a,b){for(var c=a,d=this.getBeanPostProcessors(),e=0;e<d.length;e++){var f=d[e];if(c=f.before(c,b),!c)return c}return c},q.prototype.applyBeanPostProcessorsAfterInitialization=function(a,b){for(var c=a,d=this.getBeanPostProcessors(),e=0;e<d.length;e++){var f=d[e];if(c=f.after(c,b),!c)return c}return c},q.prototype.destroySingletons=function(){for(var a=this.singletonBeanFactory.getSingletonNames(),b=0;b<a.length;b++)this.destroySingleton(a[b])},q.prototype.destroyBeanFactory=function(){this.initCbMap=null,this.beanCurMap=null,this.beanFunctions=null,this.beanDefinitions=null,this.singletonBeanFactory=null},q.prototype.destroySingleton=function(a){var b=this.getBeanDefinition(a);if(b){var c=this.getBean(a);this.destroyBean(a,c),this.singletonBeanFactory.removeSingleton(a)}},q.prototype.destroyBean=function(a,b){var c=this.getBeanDefinition(a);if(c){var d=c.getDestroyMethodName(),e=b[d];p.checkFunction(e)&&e.call(b),this.removeFunction(a),this.removeBeanDefinition(a)}},q.prototype.isSingleton=function(a){var b=this.getBeanDefinition(a);return b?b.isSingleton():!1},q.prototype.isPrototype=function(a){var b=this.getBeanDefinition(a);return b?b.isPrototype():!1},q.prototype.containsBean=function(a){return!!this.getBeanFunction(a)&&!!this.getBeanDefinition(a)},q.prototype.getBeanFunction=function(a){return this.beanFunctions[a]},q.prototype.setBeanFunction=function(a,b){this.beanFunctions[a]=b},q.prototype.removeFunction=function(a){delete this.beanFunctions[a]},q.prototype.getInitCb=function(a){return this.initCbMap[a]||(this.initCbMap[a]=m.INIT_CB_DEFAULT),this.initCbMap[a]},q.prototype.setInitCb=function(a,b){this.initCbMap[a]=b},q.prototype.getBeanDefinition=function(a){return this.beanDefinitions[a]},q.prototype.getBeanDefinitions=function(){return this.beanDefinitions},q.prototype.removeBeanDefinition=function(a){delete this.beanDefinitions[a]},q.prototype.containsBeanDefinition=function(a){return!!this.getBeanDefinition(a)},q.prototype.getAspects=function(){return this.aspects},q.prototype.getModelDefinition=function(a){return this.modelMap[a]},q.prototype.getModelDefinitions=function(){return this.modelMap},q.prototype.getConstraintDefinition=function(a){return this.constraints[a]},q.prototype.setTableModelMap=function(a,b){this.tableModelMap[a]=b},q.prototype.getModelDefinitionByTable=function(a){return this.tableModelMap[a]},b.exports=q},{"../aop/aspect":3,"../aop/framework/dynamicMetaProxy":7,"../model/modelConstraint":24,"../model/modelDefinition":25,"../model/modelFilter":26,"../model/modelProxy":28,"../util/aopUtil":35,"../util/beanUtil":36,"../util/constant":37,"../util/modelUtil":40,"../util/utils":44,"../util/validatorUtil":45,"./singletonBeanFactory":13,"./support/beanDefinition":14,"pomelo-logger":57}],12:[function(a,b){var c=a("pomelo-logger").getLogger("bearcat","ModuleFactory"),d=function(){this.factoryMap={},this.moduleMap={}};d.prototype.define=function(a,b){return this.factoryMap[a]?void c.warn("module %s has been registered ...",a):void(this.factoryMap[a]=b)},d.prototype.require=function(a){if(!this.moduleMap[a]){var b=this.factoryMap[a];if(!b)return void c.warn("require file %s not exists ...",a);var d={exports:{}};b(d.exports,d),this.moduleMap[a]=d.exports}return this.moduleMap[a]},b.exports=d},{"pomelo-logger":57}],13:[function(a,b){var c=(a("pomelo-logger").getLogger("bearcat","SingletonBeanFactory"),function(a){this.beanFactory=a,this.singletonObjects={}});c.prototype.addSingleton=function(a,b){this.singletonObjects[a]=b},c.prototype.containsSingleton=function(a){return!!this.singletonObjects[a]},c.prototype.getSingleton=function(a){var b=this.beanFactory,c=this.singletonObjects[a];return c?c:(c=b.createBean.apply(b,arguments),this.addSingleton(a,c),c)},c.prototype.getSingletonNames=function(){var a=[];for(var b in this.singletonObjects)a.push(b);return a},c.prototype.removeSingleton=function(a){delete this.singletonObjects[a]},b.exports=c},{"pomelo-logger":57}],14:[function(a,b){var c=a("../../util/constant"),d=a("../../util/beanUtil"),e=a("../../util/utils"),f=function(){this.argsOn=[],this.propsOn=[],this.func=null,this.order=null,this.proxy=!0,this.aspect=!1,this["abstract"]=!1,this.lazyInit=!1,this.asyncInit=!1,this.parentName=null,this.parentBean=null,this.beanName=null,this.factoryArgsOn={},this.factoryBeanName=null,this.factoryMethodName=null,this.initMethodName=null,this.destroyMethodName=null,this.scope=c.SCOPE_DEFAULT};f.prototype.getParentName=function(){return this.parentName},f.prototype.setParentName=function(a){a&&(this.parentName=a)},f.prototype.hasParentBean=function(){return this.getParentName()&&!this.getParentBean()},f.prototype.getParentBean=function(){return this.parentBean},f.prototype.setParentBean=function(a){a&&(this.parentBean=a)},f.prototype.getBeanName=function(){return this.beanName},f.prototype.setBeanName=function(a){return a?this.beanName=a:void 0},f.prototype.getFactoryBeanName=function(){return this.factoryBeanName?this.factoryBeanName:this.parentBean?this.parentBean.factoryBeanName:void 0},f.prototype.setFactoryBeanName=function(a){a&&(this.factoryBeanName=a)},f.prototype.getFactoryMethodName=function(){return this.factoryMethodName?this.factoryMethodName:this.parentBean?this.parentBean.factoryMethodName:void 0},f.prototype.setFactoryMethodName=function(a){a&&(this.factoryMethodName=a)},f.prototype.getScope=function(){return this.scope},f.prototype.setScope=function(a){a&&(this.scope=a)},f.prototype.isAbstract=function(){return this["abstract"]},f.prototype.setAbstract=function(a){e.isNotNull(a)&&(this["abstract"]=a)},f.prototype.isLazyInit=function(){return this.lazyInit?this.lazyInit:this.parentBean?this.parentBean.lazyInit:void 0},f.prototype.setLazyInit=function(a){e.isNotNull(a)&&(this.lazyInit=a)},f.prototype.needProxy=function(){return this.proxy},f.prototype.setProxy=function(a){e.isNotNull(a)&&(this.proxy=a)},f.prototype.isAsyncInit=function(){return this.asyncInit?this.asyncInit:this.parentBean?this.parentBean.asyncInit:void 0},f.prototype.setAsyncInit=function(a){e.isNotNull(a)&&(this.asyncInit=a)},f.prototype.setAspect=function(a){e.isNotNull(a)&&(this.aspect=a)},f.prototype.isAspect=function(){return this.aspect?this.aspect:this.parentBean?this.parentBean.aspect:void 0},f.prototype.getProps=function(){return this.propsOn},f.prototype.getPropsOn=function(){return this.propsOn},f.prototype.setPropsOn=function(a){a&&e.checkArray(a)&&a.length&&this.updateSettingsOn(this,c.SETTINGS_PROPS_ON,a)},f.prototype.getArgs=function(){return this.argsOn},f.prototype.getArgsOn=function(){return this.argsOn},f.prototype.setArgsOn=function(a){a&&e.checkArray(a)&&a.length&&this.updateSettingsOn(this,c.SETTINGS_ARGS_ON,a)},f.prototype.getFactoryArgs=function(){return this.factoryArgsOn},f.prototype.getFactoryArgsOn=function(){return this.factoryArgsOn},f.prototype.setFactoryArgsOn=function(a){a&&e.checkArray(a)&&a.length&&this.updateSettingsOn(this,c.SETTINGS_FACTORY_ARGS_ON,a)},f.prototype.getInitMethodName=function(){return this.initMethodName?this.initMethodName:this.parentBean?this.parentBean.initMethodName:void 0},f.prototype.setInitMethodName=function(a){a&&(this.initMethodName=a)},f.prototype.getDestroyMethodName=function(){return this.destroyMethodName?this.destroyMethodName:this.parentBean?this.parentBean.destroyMethodName:void 0},f.prototype.setDestroyMethodName=function(a){a&&(this.destroyMethodName=a)},f.prototype.getFunc=function(){return this.func},f.prototype.setFunc=function(a){this.func||(this.func=a)},f.prototype.getOrder=function(){return this.order||0==this.order?this.order:this.parentBean?this.parentBean.order:void 0},f.prototype.setOrder=function(a){e.isNotNull(a)&&(this.order=a)},f.prototype.isSingleton=function(){return this.scope===c.SCOPE_SINGLETON},f.prototype.isPrototype=function(){return this.scope===c.SCOPE_PROTOTYPE},f.prototype.hasFactoryBean=function(){return e.isNotNull(this.factoryBeanName)&&e.isNotNull(this.factoryMethodName)},f.prototype.hasInitMethod=function(){return e.isNotNull(this.initMethodName)},f.prototype.hasParent=function(){return e.isNotNull(this.parentName)},f.prototype.updateSettingsOn=function(a,b,c){var e=a[b],f=d.getBeanSettingsMap(e),g=d.getBeanSettingsMap(c);for(var h in g)f[h]||(f[h]=g[h]);a[b]=d.getBeanSettingsArray(f)},b.exports=f},{"../../util/beanUtil":36,"../../util/constant":37,"../../util/utils":44}],15:[function(a,b){var c=a("pomelo-logger").getLogger("bearcat","BeanDefinitionVisitor"),d=a("../../util/constant"),e=a("../../util/utils"),f=function(a){this.valueResolver=a};f.prototype.setValueResolver=function(a){this.valueResolver=a},f.prototype.getValueResolver=function(){return this.valueResolver},f.prototype.resolveStringValue=function(a){if(!this.valueResolver)return void c.error("No StringValueResolver specified");var b=this.getValueResolver().resolveStringValue(a);return b},f.prototype.visitBeanDefinition=function(a){this.visitParentName(a),this.visitPropertyValues(a),this.visitArgumentsValues(a)},f.prototype.visitParentName=function(a){var b=a.getParentName();if(e.isNotNull(b)){var c=this.resolveStringValue(b);b!==c&&e.isNotNull(c)&&a.setParentName(c)}},f.prototype.visitPropertyValues=function(a){for(var b=a.getProps(),c=0;c<b.length;c++){var f=b[c];if(f.getDependType()===d.DEPEND_TYPE_VALUE){var g=f.getValue(),h=this.resolveStringValue(g);g!==h&&e.isNotNull(h)&&f.setValue(h)}}},f.prototype.visitArgumentsValues=function(a){for(var b=a.getArgs(),c=0;c<b.length;c++){var f=b[c];if(f.getDependType()===d.DEPEND_TYPE_VALUE){var g=f.getValue(),h=this.resolveStringValue(g);g!==h&&e.isNotNull(h)&&f.setValue(h)}}},b.exports=f},{"../../util/constant":37,"../../util/utils":44,"pomelo-logger":57}],16:[function(a,b){var c,d=a("../../util/requestUtil"),e=(a("../../util/utils"),{}),f={},g={},h={INIT:0,FETCHING:1,SAVED:2,LOADING:3,LOADED:4,ERROR:5},i=function(a,b,c){this.uri=a,this.dependencies=b||[],this.deps={},this.remain=0,this.entries=[],this.history={},this.loader=c,this.callback=null,this.status=h.INIT};i.prototype.resolve=function(){for(var a=this,b=a.dependencies,c=[],d=this.getLoader(),e=b.length,f=0;e>f;f++)c[f]=d.resolve(b[f],a.uri);return c},i.prototype.pass=function(){for(var a=this,b=a.dependencies.length,c=0;c<a.entries.length;c++){for(var d=a.entries[c],e=0,f=0;b>f;f++){var g=a.deps[a.dependencies[f]];g.status<h.LOADED&&!d.history.hasOwnProperty(g.uri)&&(d.history[g.uri]=!0,e++,g.entries.push(d),g.status===h.LOADING&&g.pass())}e>0&&(d.remain+=e-1,a.entries.shift(),c--)}},i.prototype.load=function(){var a=this;if(!(this.status>=h.LOADING)){var b=this.getLoader();a.status=h.LOADING;for(var c=a.resolve(),d=0,e=c.length;e>d;d++)a.deps[a.dependencies[d]]=b.get(c[d]);if(a.pass(),a.entries.length)return void a.onload();var f,g={};for(d=0;e>d;d++)f=b.get(c[d]),f.status<h.FETCHING?f.fetch(g):f.status===h.SAVED&&f.load();for(var i in g)g.hasOwnProperty(i)&&g[i]()}},i.prototype.onload=function(){var a=this;a.status=h.LOADED;for(var b=(a.entries||[]).length,c=0;b>c;c++){var d=a.entries[c];0===--d.remain&&d.callback()}delete a.entries},i.prototype.error=function(){var a=this;a.onload(),a.status=h.ERROR},i.prototype.fetch=function(a){function b(){d.request(m.requestUri,m.onRequest,m.charset,m.crossorigin)}function i(a){delete e[n],f[n]=!0,c&&(l.save(k,c),c=null);var b,d=g[n];for(delete g[n];b=d.shift();)a===!0?b.error():b.load()}var j=this,k=j.uri;console.log("do fetch "+k);var l=this.getLoader();j.status=h.FETCHING;var m={uri:k},n=m.requestUri||k;return!n||f.hasOwnProperty(n)?void j.load():e.hasOwnProperty(n)?void g[n].push(j):(e[n]=!0,g[n]=[j],m={uri:k,requestUri:n,onRequest:i,charset:"utf-8",crossorigin:!1},void(m.requested||(a?a[m.requestUri]=b:b())))},i.prototype.addEntry=function(a){this.entries.push(a)},i.prototype.setRemain=function(a){this.remain=a},i.prototype.setLoader=function(a){this.loader=a},i.prototype.getLoader=function(){return this.loader},i.STATUS=h,i.anonymousMeta=c,b.exports=i},{"../../util/requestUtil":41,"../../util/utils":44}],17:[function(a,b){var c=(a("pomelo-logger").getLogger("bearcat","BeanWrapper"),a("../../util/constant")),d=a("../../util/utils"),e=function(){this.name=null,this.type=null,this.value=null,this.ref=null,this.role=null,this.bean=null};e.prototype.getDependType=function(){return this.role},e.prototype.getName=function(){return this.name},e.prototype.setName=function(a){this.name=a},e.prototype.getType=function(){return this.type},e.prototype.setType=function(a){this.type=a},e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(a){this.value=a},e.prototype.getValueOnce=function(){var a=this.value;return this.value=null,a},e.prototype.getRef=function(){return this.ref},e.prototype.setRef=function(a){this.ref=a},e.prototype.getRole=function(){return this.role},e.prototype.setRole=function(){var a=c.DEPEND_TYPE_ERROR;this.name||(a=c.DEPEND_TYPE_ERROR),this.ref&&(a=c.DEPEND_TYPE_BEAN),this.value&&(a=c.DEPEND_TYPE_VALUE),this.type&&d.checkType(this.type)&&(a=c.DEPEND_TYPE_VAR),this.role=a},e.prototype.getBean=function(){return this.bean},e.prototype.setBean=function(a){this.bean=a},b.exports=e},{"../../util/constant":37,"../../util/utils":44,"pomelo-logger":57}],18:[function(a,b){(function(c){var d,e=a("../../resource/propertiesLoader"),f=a("./beanDefinitionVisitor"),g=a("./placeHolderResolver"),h=a("../../util/constant"),i=a("../../util/utils"),j=c.cwd()+"/config";!function(){d=this}();var k=function(){this.beanName=null,this.env=h.DEFAULT_ENV,this.cpath=j,this.properties={}};k.prototype.postProcessBeanFactory=function(a){this.loadProperties(),this.processProperties(a)},k.prototype.loadProperties=function(){var a=null;
a=d.__bearcatData__&&d.__bearcatData__.configData?d.__bearcatData__.configData:this.getPropertiesLoader().loadProperties(this.getConfigPath(),this.getEnv()),this.mergeProperties(a)},k.prototype.mergeProperties=function(a){for(var b in a)i.isNotNull(a[b])&&(this.properties[b]=a[b])},k.prototype.processProperties=function(a){var b=this.getProperties();if(!i.checkObjectEmpty(b)){var c=new g(b);this.doProcessProperties(a,c)}},k.prototype.doProcessProperties=function(a,b){var c=new f(b),d=a.getBeanDefinitions();for(var e in d){var g=d[e];c.visitBeanDefinition(g)}},k.prototype.getPropertiesLoader=function(){return new e},k.prototype.setBeanName=function(a){this.beanName=a},k.prototype.getBeanName=function(){return this.beanName},k.prototype.setEnv=function(a){this.env=a},k.prototype.getEnv=function(){return this.env},k.prototype.setConfigPath=function(a){this.cpath=a},k.prototype.getConfigPath=function(){return this.cpath},k.prototype.setProperties=function(a){this.properties=a},k.prototype.getProperties=function(){return this.properties},b.exports=k}).call(this,a("_process"))},{"../../resource/propertiesLoader":33,"../../util/constant":37,"../../util/utils":44,"./beanDefinitionVisitor":15,"./placeHolderResolver":19,_process:51}],19:[function(a,b){var c=a("../../util/utils"),d="${",e="}",f=":",g=function(a){this.placeholderPrefix=d,this.placeholderSuffix=e,this.valueSeparator=f,this.properties=a};g.prototype.resolveStringValue=function(a){if(!c.checkString(a))return null;var b=this.doReplace(a);return c.isNotNull(b)||(b=a),b},g.prototype.setProperties=function(a){this.properties=a},g.prototype.getProperties=function(){return this.properties},g.prototype.doReplace=function(a){var b=this.getProperties();if(!a||!b)return null;for(var c,d,e,f=/\$\{(.*?)\}/g,g="",h=0,i=!0,j=0;c=f.exec(a);)d=c[1],e=a.substring(h,c.index),e.length&&(g+=e),h=f.lastIndex,0!=j||e.length?g+=b[d]:g=b[d],i=!1;return h<a.length&&(g+=a.substring(h)),i?null:g},b.exports=g},{"../../util/utils":44}],20:[function(a,b){var c,d=a("pomelo-logger").getLogger("bearcat","app"),e=a("./context/applicationContext"),f=a("events").EventEmitter,g=(a("./beans/beanFactory"),a("../package.json")),h=a("./util/utils");!function(){c=this}();var i=1,j=2,k=3,l=4,m={opts:null,configLocations:null,applicationContext:null,state:i,startTime:null,version:g.version};m.__proto__=f.prototype,m.createApp=function(a,b){return this.state>=j&&m.stop(),!h.checkArray(a)&&h.checkObject(a)&&(b=a,a=[]),this.opts=b||{},this.configLocations=a||[],this.opts.BEARCAT_GLOBAL&&(c.bearcat=m),h.checkObject(this.opts)||d.warn("Bearcat createApp opts must be object..."),this.applicationContext=new e(this.configLocations,this.opts),this.state=j,m},m.start=function(a){if(h.checkFunction(a)||(a=function(){}),this.state>j)return d.warn("Bearcat has already start, run bearcat.stop to start again."),a();if(this.state<j)return d.warn("Bearcat does not inited, run bearcat.createApp to init."),a();this.state=k,this.startTime=Date.now();var b=this,c="";h.checkBrowser()&&(c="browser",this.applicationContext.setEnv(c)),h.checkCocos2dJsb()&&(c="cocos2djsb",this.applicationContext.setEnv(c)),this.applicationContext.on("finishRefresh",function(){b.state=l,c=b.applicationContext.getEnv(),d.info("Bearcat startup in %s with %s ms",c,Date.now()-b.startTime),a()}),this.applicationContext.on("reload",function(){b.emit("reload")}),this.applicationContext.refresh()},m.stop=function(){this.applicationContext&&this.applicationContext.destroy(),this.applicationContext=null,this.configLocations=null,this.startTime=null,this.state=i},m.getBeanFactory=function(){return this.state<=j?void d.warn("Bearcat application is not running now for %s","getBeanFactory"):this.applicationContext.getBeanFactory()},m.getApplicationContext=function(){return this.state<=j?void d.warn("Bearcat application is not running now for %s","getApplicationContext"):this.applicationContext},m.getBeanByMeta=function(a){return this.state<=j?void d.warn("Bearcat application is not running now for %s %j","getBeanByMeta",a):this.applicationContext.getBeanByMeta(a)},m.getBeanByFunc=function(a){return this.state<=j?void d.warn("Bearcat application is not running now for %s","getBeanByFunc"):this.applicationContext.getBeanByFunc(a)},m.use=function(a){return h.checkArray(a)?this.applicationContext.use(a):h.checkString(a)?this.applicationContext.use([a]):void 0},m.async=function(a,b){return h.checkArray(a)?this.applicationContext.async(a,b):h.checkString(a)?this.applicationContext.async([a],b):void 0},m.module=function(a,b){return this.state<l?this.applicationContext.module(a,b):this.getBean(a)},m.define=function(a,b,c){return this.applicationContext.define(a,b,c)},m.require=function(a){return this.applicationContext.require(a)},m.getBean=function(a){if(this.state<=j)return void d.warn("Bearcat application is not running now for %s %s state: %d","getBean",a,this.state);var b=a,c="";if(h.checkObject(b))c="getBeanByMeta";else if(h.checkFunction(b))c="getBeanByFunc";else{if(!h.checkString(b))return void d.error("Bearcat application unsupported getBean arguments for %s",a);c="getBean"}return this.applicationContext[c].apply(this.applicationContext,arguments)},m.getFunction=function(a){return this.state<=j?void d.warn("Bearcat application is not running now for %s %s state: %d","getFunction",a,this.state):this.applicationContext.getBeanFunction(a)},m.getModel=function(a){return this.state<=j?void d.warn("Bearcat application is not running now for %s %s state: %d","getModel",a,this.state):this.applicationContext.getModel(a)},m.getRoute=function(a,b){if(this.state===l){var c=this.getBean(a);return c[b].bind(c)}},b.exports=m},{"../package.json":54,"./beans/beanFactory":11,"./context/applicationContext":21,"./util/utils":44,events:47,"pomelo-logger":57}],21:[function(a,b){(function(c){var d,e=a("pomelo-logger").getLogger("bearcat","ApplicationContext"),f=a("../beans/support/placeHolderConfigurer"),g=a("../aop/autoproxy/autoProxyCreator"),h=a("../model/modelKeyMapResolver"),i=a("../resource/asyncScriptLoader"),k=a("../resource/bootStrapLoader"),l=a("../resource/resourceLoader"),m=a("../model/constraints"),n=a("../beans/moduleFactory"),o=a("../beans/beanFactory"),p=a("events").EventEmitter,q=a("../util/requireUtil"),r=a("../util/constant"),s=a("../util/fileUtil"),t=a("../util/metaUtil"),u=a("../util/utils"),v=q.requirePath(),w=q.requireUtil(),x="",y="",z="";!function(){d=this}();var A=function(a,b){this.opts=b||{},this.configLocations=a,this.loadBeans=[],this.active=!1,this.reloadMap={},this.beanFactory=null,this.startUpDate=null,this.moduleFactory=null,this.resourceLoader=null,this.bootStrapLoader=null,this.asyncScriptLoader=null,this.cpath=y,this.hpath=z,this.env=r.DEFAULT_ENV,this.base=x,this.beanFactoryPostProcessors=[],p.call(this),this.init()};b.exports=A,w.inherits(A,p),A.prototype.init=function(){if(this.hasBeanFactory()&&(this.destroyBeans(),this.closeBeanFactory()),x=c.cwd(),this.configLocations.length){var a=this.configLocations[0];x=v.dirname(a)}y=x+"/config",z=x+"/app",this.cpath=y,this.hpath=z,this.base=x,this.createBeanFactory()},A.prototype.setStartupDate=function(a){this.startUpDate=a},A.prototype.getStartupDate=function(){return this.startUpDate},A.prototype.getResourceLoader=function(){return this.resourceLoader=new l,this.resourceLoader},A.prototype.getAsyncScriptLoader=function(){return this.asyncScriptLoader?this.asyncScriptLoader:(this.asyncScriptLoader=new i,this.asyncScriptLoader.setApplicationContext(this),this.asyncScriptLoader)},A.prototype.getBootStrapLoader=function(){return this.bootStrapLoader?this.bootStrapLoader:(this.bootStrapLoader=new k,this.bootStrapLoader)},A.prototype.getResource=function(a){return d.__bearcatData__&&d.__bearcatData__.metas?d.__bearcatData__.metas:this.resourceLoader.load(a)},A.prototype.getConfigLocations=function(){return this.configLocations},A.prototype.addBeanFactoryPostProcessor=function(a){this.beanFactoryPostProcessors.push(a)},A.prototype.getBeanFactoryProcessors=function(){return this.beanFactoryPostProcessors},A.prototype.refresh=function(a){var b=this;a=a||function(){},b.prepareRefresh(),b.refreshBeanFactory(),b.tryAsyncLoading(function(){b.tryBootStrapLoading(),b.prepareBeanFactory(),b.postProcessBeanFactory(),b.invokeBeanFactoryPostProcessors(),b.registerBeanPostProcessors(),b.finishBeanFactoryIntialization(function(){b.finishRefresh(),a()})})},A.prototype.prepareRefresh=function(){this.startUpDate=Date.now(),this.active=!0;var b=this.opts;b.NODE_ENV&&(c.env.NODE_ENV=b.NODE_ENV),b.BEARCAT_ENV&&(c.env.BEARCAT_ENV=b.BEARCAT_ENV),b.NODE_CPATH&&(c.env.NODE_CPATH=b.NODE_CPATH),b.BEARCAT_CPATH&&(c.env.BEARCAT_CPATH=b.BEARCAT_CPATH),b.BEARCAT_LOGGER&&"off"===b.BEARCAT_LOGGER&&(c.env.BEARCAT_LOGGER="off"),b.BEARCAT_HOT&&"on"===b.BEARCAT_HOT&&(c.env.BEARCAT_HOT="on"),b.BEARCAT_ANNOTATION&&"off"===b.BEARCAT_ANNOTATION&&(c.env.BEARCAT_ANNOTATION="off"),b.BEARCAT_FUNCTION_STRING&&(c.env.BEARCAT_FUNCTION_STRING=!0),this.getResourceLoader(),this.beanFactoryPostProcessors=[];var d=u.parseArgs(c.argv),e=this.getEnv();e=d.env||d["--env"]||c.env.NODE_ENV||c.env.BEARCAT_ENV||e||r.DEFAULT_ENV,this.setEnv(e);var f=this.getConfigPath();if(f=d.cpath||d["--cpath"]||c.env.NODE_CPATH||c.env.BEARCAT_CPATH||f,this.setConfigPath(f),!u.checkBrowser()){t.cleanUp();var g=this.getBase();if("off"!==c.env.BEARCAT_LOGGER){var h=v.join(f,r.LOGPATH),i=v.join(f,e,r.LOGPATH);s.existsSync(h)?a("pomelo-logger").configure(h,{base:g}):s.existsSync(i)&&a("pomelo-logger").configure(i,{base:g})}var j=this.getHotPath();j=d.hpath||d["--hpath"]||b.BEARCAT_HPATH||j,this.setHotPath(j),"on"===c.env.BEARCAT_HOT&&this.hotReloadFileWatch(j)}},A.prototype.refreshBeanFactory=function(){this.configLocations=this.getConfigLocations(),this.loadDefaultConstraints();for(var a=this.configLocations.length,b=0;a>b;b++)this.beanFactory.registerBeans(this.getResource(this.configLocations[b]));a||this.beanFactory.registerBeans(this.getResource())},A.prototype.tryAsyncLoading=function(a){if(!u.checkBrowser()||u.checkCocos2dJsb())return a();var b=this.loadBeans;return b&&b.length?this.doAsyncLoading(a):a()},A.prototype.doAsyncLoading=function(a){var b=this.loadBeans,c=this.getAsyncScriptLoader();return c.load(b,a)},A.prototype.tryBootStrapLoading=function(){if(u.checkCocos2dJsb()&&d.__bearcatData__&&d.__bearcatData__.idPaths){idPaths=d.__bearcatData__.idPaths;var a=this.getBootStrapLoader();return a.load(idPaths)}},A.prototype.prepareBeanFactory=function(){var a=new f;u.isNotNull(this.env)&&a.setEnv(this.env),u.isNotNull(this.cpath)&&a.setConfigPath(this.cpath);var b=new h;this.addBeanFactoryPostProcessor(a),this.addBeanFactoryPostProcessor(b)},A.prototype.registerBeanMeta=function(a){var b=a.id;if(!b)return void e.error("ApplicationContext registerBean error meta no id.");var c={};c[b]=a,this.beanFactory.registerBeans(c)},A.prototype.loadDefaultConstraints=function(){for(var a in m)this.getBeanByFunc(m[a])},A.prototype.hotReloadFileWatch=function(b){var c=this,d=a("chokidar").watch(b,{ignored:/[\/\\]\./,ignoreInitial:!0});d&&(e.info("bearcat hot reload watch %j",b),d.on("all",function(a,b){if("change"==a||"add"==a){var d=b;if(u.checkString(d)){var f=u.getFileName(d,".js".length);if(u.checkFileType(d,".js")&&u.isFile(d)){var g=Math.floor(5*Math.random(0,1)),h=Math.floor(100*Math.random(0,1)),i=function(){e.info("%j changed, bearcat start hot reloading ...",d);var b=u.myRequireHot(d);if(b){if(u.checkFunction(b)&&(b=t.resolveFuncAnnotation(b,null,!0)),u.checkObject(b)){f=b.id;var g=b.func;if("add"==a)e.info("bearcat reload add bean %s",f),c.registerBeanMeta(b);else if(f&&u.checkFunction(g)){var h=c.getBeanFactory(),i=h.getBeanFunction(f);if(c.doHotAddAttributes(b,f),i){var j=g.prototype;e.info("bearcat reload update bean %s",f);for(var k in j)i.prototype[k]=j[k]}}}c.emit("reload"),e.info("bearcat hot reloading done ...")}};setTimeout(i,1e3*g+h+g)}}}}))},A.prototype.doHotAddAttributes=function(a,b){var c=this.getBeanFactory(),d=c.getBeanFunction(b),f=c.getBeanDefinition(b);if(f){var g=d.prototype,h=f.getPropsOn(),i=a.props;if(u.checkArray(i))for(var k=0;k<i.length;k++)!function(a){var d=a.name,f=1;for(j=0;j<h.length;j++){var i=h[j];if(d===i.getName()){f=0;break}}if(f){var k=a.value,l=a.ref,m="";l&&(m=r.DEFINE_GETTER_PREFIX+d),e.info("hot reload add attribute %s to %s",d,b),g.__defineGetter__(d,function(){return k?k:l?(this[m]||(this[m]=c.getBean(l)),this[m]):void 0})}}(i[k])}},A.prototype.postProcessBeanFactory=function(){},A.prototype.registerBeanPostProcessors=function(){var a=new g;a.setBeanFactory(this.getBeanFactory()),this.beanFactory.addBeanPostProcessor(a)},A.prototype.invokeBeanFactoryPostProcessors=function(){for(var a=this.getBeanFactory(),b=this.getBeanFactoryProcessors(),c=0;c<b.length;c++){var d=b[c];d.postProcessBeanFactory(a)}},A.prototype.finishBeanFactoryIntialization=function(a){this.beanFactory.preInstantiateSingletons(a)},A.prototype.finishRefresh=function(){var a=this;if(this.emit("finishRefresh"),!c.browser){var b=c.listeners("SIGINT");if(!b||!b.length){var d=!1,f=function(){d||(d=!0,e.info("Bearcat starts destroying..."),a.destroy(),c.exit())};c.on("SIGINT",f),c.on("SIGTERM",f),c.on("SIGHUP",f)}}},A.prototype.cancelRefresh=function(){this.active=!1},A.prototype.registerShutdownHook=function(){},A.prototype.destroy=function(){this.close()},A.prototype.close=function(){this.doClose()},A.prototype.doClose=function(){this.configLocations=null,this.startUpDate=null,this.active=!1,this.hasBeanFactory()&&(this.destroyBeans(),this.closeBeanFactory()),t.cleanUp(),this.beanFactory=null,this.resourceLoader=null,this.beanFactoryPostProcessors=[],this.cpath=y,this.env=r.DEFAULT_ENV,this.emit("destroyed")},A.prototype.destroyBeans=function(){this.getBeanFactory().destroySingletons()},A.prototype.isActive=function(){return this.active},A.prototype.getBean=function(){var a=this.getBeanFactory();return a.getBean.apply(a,arguments)},A.prototype.getBeanByMeta=function(a){var b=a.id;return b?(this.getBeanDefinition(b)||(this.registerBeanMeta(a),this.invokeBeanFactoryPostProcessors()),arguments[0]=b,this.beanFactory.getBeanProxy.apply(this.beanFactory,arguments)):void e.error("ApplicationContext getBeanByMeta error meta no id.")},A.prototype.getBeanByFunc=function(a){var b=t.resolveFuncAnnotation(a),c=b.id;return c?(this.getBeanDefinition(c)||(b.lazy=!0,this.registerBeanMeta(b),this.invokeBeanFactoryPostProcessors()),arguments[0]=c,this.beanFactory.getBeanProxy.apply(this.beanFactory,arguments)):void e.error('ApplicationContext getBeanByFunc error meta no id, add this.$id = "yourId" to your func.')},A.prototype.getModel=function(a){return a?this.beanFactory.getModelProxy(a):void e.error("ApplicationContext getModel error no modelId.")},A.prototype.getModelDefinition=function(a){return a?this.beanFactory.getModelDefinition(a):void e.error("ApplicationContext getModelDefinition error no modelId.")},A.prototype.getBeanFunction=function(a){return this.beanFactory.getBeanFunction(a)},A.prototype.module=function(a,b){var c=t.resolveFuncAnnotation(a),d=c.id;if(!d)return void e.error('ApplicationContext module error meta no id, add this.$id = "yourId" to your func.');if(!this.getBeanDefinition(d)){if(!u.checkBrowser()&&u.isNotNull(b)&&b.exports)return b.exports=a;if(u.checkBrowser()){var f=this.getAsyncScriptLoader();f.module(d,c)}return this.registerBeanMeta(c)}},A.prototype.define=function(a,b,d){return c.env.LOADER_BIN&&u.isNotNull(d)&&d.exports?d.exports={id:a,func:b}:this.getModuleFactory().define(a,b)},A.prototype.require=function(a){return this.getModuleFactory().require(a)},A.prototype.use=function(a){this.loadBeans=this.loadBeans.concat(a)},A.prototype.async=function(a,b){var c=new i;return c.load(loadBeans,b)},A.prototype.containsBean=function(a){return this.getBeanFactory().containsBean(a)},A.prototype.isSingleton=function(a){return this.getBeanFactory().isSingleton(a)},A.prototype.isPrototype=function(a){return this.getBeanFactory().isPrototype(a)},A.prototype.containsBeanDefinition=function(a){return this.getBeanFactory().containsBeanDefinition(a)},A.prototype.isRunning=function(){return this.active},A.prototype.closeBeanFactory=function(){this.getBeanFactory().destroyBeanFactory(),this.beanFactory=null},A.prototype.hasBeanFactory=function(){return null!=this.beanFactory},A.prototype.getBeanFactory=function(){return this.beanFactory},A.prototype.getModuleFactory=function(){return this.moduleFactory||(this.moduleFactory=new n),this.moduleFactory},A.prototype.createBeanFactory=function(){this.beanFactory=new o},A.prototype.getBeanDefinition=function(a){return this.getBeanFactory().getBeanDefinition(a)},A.prototype.removeBeanDefinition=function(a){return this.getBeanFactory().removeBeanDefinition(a)},A.prototype.setEnv=function(a){this.env=a},A.prototype.getEnv=function(){return this.env},A.prototype.setConfigPath=function(a){this.cpath=a},A.prototype.getConfigPath=function(){return this.cpath},A.prototype.setHotPath=function(a){this.hpath=a},A.prototype.getHotPath=function(){return this.hpath},A.prototype.getBase=function(){return this.base}}).call(this,a("_process"))},{"../aop/autoproxy/autoProxyCreator":4,"../beans/beanFactory":11,"../beans/moduleFactory":12,"../beans/support/placeHolderConfigurer":18,"../model/constraints":22,"../model/modelKeyMapResolver":27,"../resource/asyncScriptLoader":29,"../resource/bootStrapLoader":30,"../resource/resourceLoader":34,"../util/constant":37,"../util/fileUtil":38,"../util/metaUtil":39,"../util/requireUtil":42,"../util/utils":44,_process:51,chokidar:56,events:47,"pomelo-logger":57}],22:[function(a,b){(function(c){var d=a("../../util/utils"),e={};if(!d.checkBrowser()){var f=a("fs"),g=a("path");f.readdirSync(c).forEach(function(b){function d(){return a(c+"/"+f)}if(/\.js$/.test(b)&&"index.js"!==b){var f=g.basename(b,".js");e.__defineGetter__(f,d)}})}b.exports=e}).call(this,"/lib/model/constraints")},{"../../util/utils":44,fs:46,path:50}],23:[function(a,b){var c=a("../util/constant"),d=a("../util/utils"),e=a("util"),f=function(){this.ref=null,this.name=null,this.type=null,this.prefix=null,this["default"]=null,this.primary=!1,this.balance=!1,this.constraints=[],this.expression=null};f.prototype.filter=function(a){if(d.isNotNull(a)){var b=this.filterType(a);if(d.checkModelFilterError(b))return b;for(var e=this.name,f=this.constraints,g=c.CONSTRAINT_METHOD,h=0;h<f.length;h++){var i=f[h];if(i&&d.checkFunction(i[g])&&(b=i[g](e,a),d.checkModelFilterError(b)))return b}}},f.prototype.filterType=function(a){var b=this.type;if(d.checkString(b)){var c=b,f=d.isType(c),g=f(a);if(g!==!0){var h="field: %s with value: %s error, type not matched with %s";return new Error(e.format(h,this.name,a,c))}}},f.prototype.parse=function(a,b){if(a){a=a.replace(/\s/g,"");var e=a[0];if(e===c.CONSTRAINT_ANNOTATION){a=a.substr(1);for(var f=a.split(c.CONSTRAINT_SPLIT),g=0;g<f.length;g++){var h="",i="",j=-1,k=[],l=f[g];if(l)if(l!==c.MODEL_ATTRIBUTE_PRIMARY)if(l!==c.MODEL_ATTRIBUTE_BALANCE){if(j=l.indexOf(":"),-1!=j){var m=l.split(":");if(h=m[0].toLowerCase(),m.length>=2){if(i=m[1],this.checkProps(h)){"type"===h&&(i=d.normalizeType(i)),this[h]=i;continue}k.push({name:h,value:i})}}if(j=l.indexOf("("),-1!=j){if(h=l.substr(0,j),!h)continue;var n=l.substr(j),o=n.length,p=n[o-1];if(")"!==p)continue;n=n.substr(1,o-2);for(var q=n.split(","),r=0;r<q.length;r++){var s=q[r].split("="),t=s.length;2>t||s[0]&&s[1]&&k.push({name:s[0],value:s[1]})}}h||(h=l);var u=b.getConstraint(h);if(u){var v=b.getConstraintDefinition(h),w=v.getConstraint();w&&this.parse(w,b);var x=k.length;if(x)for(var y=0;x>y;y++){var z=k[y],A=z.name,B=z.value;u[A]=B}this.addConstraints(u)}}else this[l]=!0;else this[l]=!0}}}},f.prototype.setExpression=function(a){this.expression=a},f.prototype.getExpression=function(){return this.expression},f.prototype.setRef=function(a){this.ref=a},f.prototype.getRef=function(){return this.ref},f.prototype.setName=function(a){this.name=a},f.prototype.getName=function(){return this.name},f.prototype.setType=function(a){this.type=a},f.prototype.getType=function(){return this.type},f.prototype.setPrimary=function(a){this.primary=a},f.prototype.getPrimary=function(){return this.primary},f.prototype.setDefault=function(a){this["default"]=a},f.prototype.getDefault=function(){return this["default"]},f.prototype.setPrefix=function(a){this.prefix=a},f.prototype.getPrefix=function(){return this.prefix},f.prototype.isPrimary=function(){return this.primary},f.prototype.isBalance=function(){return this.balance},f.prototype.addConstraints=function(a){this.constraints.push(a)},f.prototype.checkProps=function(a){for(var b=c.MODEL_ATTRIBUTES,d=0;d<b.length;d++)if(a===b[d])return!0;return!1},b.exports=f},{"../util/constant":37,"../util/utils":44,util:53}],24:[function(a,b){var c=function(){this.id=null,this.cid=null,this.constraint=null};c.prototype.setId=function(a){this.id=a},c.prototype.getId=function(){return this.id},c.prototype.setCid=function(a){this.cid=a},c.prototype.getCid=function(){return this.cid},c.prototype.setConstraint=function(a){this.constraint=a},c.prototype.getConstraint=function(){return this.constraint},b.exports=c},{}],25:[function(a,b){var c=a("../util/utils"),d=function(){this.id=null,this.mid=null,this.table=null,this.prefix=null,this.balance=null,this.fields={},this.refFields=[],this.modelKeyMap={},this.oneToMany=!1};d.prototype.setId=function(a){this.id=a},d.prototype.getId=function(){return this.id},d.prototype.setMid=function(a){this.mid=a},d.prototype.getMid=function(){return this.mid},d.prototype.setTable=function(a){a&&(this.table=a)},d.prototype.getTable=function(){return this.table},d.prototype.setPrefix=function(a){a&&(this.prefix=a)},d.prototype.getPrefix=function(){return this.prefix},d.prototype.setBalance=function(a){a&&(this.balance=a)},d.prototype.getBalance=function(){return this.balance},d.prototype.setFields=function(a){c.isNotNull(a)&&(this.fields=a)},d.prototype.getFields=function(){return this.fields},d.prototype.getField=function(a){return this.fields[a]},d.prototype.addRefField=function(a){this.refFields.push(a)},d.prototype.setRefFields=function(a){c.isNotNull(a)&&(this.refFields=a)},d.prototype.getRefFields=function(){return this.refFields},d.prototype.setModelKeyMap=function(a){this.modelKeyMap=a},d.prototype.getModelKeyMap=function(){return this.modelKeyMap},d.prototype.setOneToMany=function(a){this.oneToMany=a},d.prototype.isOneToMany=function(){return this.oneToMany},b.exports=d},{"../util/utils":44}],26:[function(a,b){var c=(a("pomelo-logger").getLogger("bearcat","ModelFilter"),a("../util/utils")),d=function(){this.modelBean=null,this.modelDefinition=null};d.prototype.setModel=function(a){this.modelBean=a},d.prototype.getModel=function(){return this.modelBean},d.prototype.setModelDefinition=function(a){this.modelDefinition=a},d.prototype.getModelDefinition=function(){return this.modelDefinition},d.prototype.filter=function(a,b){return c.checkString(a)?this.doFilterKey(a,b):this.doFilterKeys()},d.prototype.doFilterKey=function(a,b){var c=this.modelDefinition.getField(a);return c?c.filter(b):void 0},d.prototype.doFilterKeys=function(){var a=this.modelDefinition.getFields();for(var b in a){var d=a[b],e=this.modelBean[b],f=d.filter(e);if(c.checkModelFilterError(f))return f}},b.exports=d},{"../util/utils":44,"pomelo-logger":57}],27:[function(a,b){var c=a("pomelo-logger").getLogger("bearcat","ModelKeyMapResolver"),d=function(){};d.prototype.postProcessBeanFactory=function(a){this.processModelKeyMap(a)},d.prototype.processModelKeyMap=function(a){var b=a.getModelDefinitions();for(var c in b){var d=b[c],e={};this.processModelDefinition(a,d,e,{}),d.setModelKeyMap(e)}},d.prototype.processModelDefinition=function(a,b,d,e){var f=b.getFields(),g=b.getMid(),h=b.getPrefix(),i=e.prefix||h,j=e.pid,k=e.ptype,l=e.pfield;for(var m in f){var n=f[m],m=n.getName(),o=n.getRef(),p=n.getPrefix(),q=n.getType(),r="";if(i&&(r+=i),r+=m,o){var s=a.getModelDefinition(o);if(!s){c.warn("model field ref id %s not exsit",o);continue}var e={pid:g,ptype:q,pfield:m};p&&(e.prefix=p),this.processModelDefinition(a,s,d,e)}else d[r]={id:g,pid:j,ptype:k,pfield:l,fieldName:m,type:q}}},b.exports=d},{"pomelo-logger":57}],28:[function(a,b){var c=a("pomelo-logger").getLogger("bearcat","ModelProxy"),d=a("../util/constant"),e=a("../util/utils"),f=function(){this.model=null,this.modelFilter=null,this.beanFactory=null,this.beanDefinition=null,this.modelDefinition=null,this.beforeNames=[],this.afterNames=[],this.beforeName=null,this.afterName=null,this.beforeFlag=!1,this.afterFlag=!1};f.prototype.$set=function(a,b){var c=this.model;this.beforeFlag=!0;var f=this._getFilters(d.MODEL_FILTER_BEFORE),g=this._doFilters(f,a,b);if(e.checkModelFilterError(g))return this._result(g);c[a]=b;var h=this._getFilters(d.MODEL_FILTER_AFTER);return g=this._doFilters(h,a,b),this._result(e.checkModelFilterError(g)?g:g)},f.prototype.$get=function(a){return this.model[a]},f.prototype.$pack=function(a){if(!e.checkObject(a))return new Error("pack data must be Object");var b=this.model;for(var c in a){var f=a[c];b[c]=f}this.afterFlag=!0;var g=this._getFilters(d.MODEL_FILTER_AFTER),h=this._doFilters(g);return this._result(e.checkModelFilterError(h)?h:h)},f.prototype.$packResultSet=function(a){if(!e.checkObject(a))return new Error("resultSet must be Object");var b=this.beanFactory,d=this.modelDefinition.getMid(),f=this;if(!f)return void c.error("packResultSet error no such result model %s",d);var g=this.modelDefinition.getModelKeyMap(),h=a,i={};for(var j in h){var k=h[j];if(!e.checkFunction(k)){var l=g[j];if(l){var m,n=l.id,o=l.fieldName,p=(l.type,l.pid||n),q=l.pfield||o,r=l.ptype;if(e.checkTypeArray(r)||e.checkTypeObject(r)){var s=p+"_"+q;m=i[s],m||(m=b.getModelProxy(n),i[s]=m)}else m=this;var t=m.$before().$set(o,k);if(e.checkModelFilterError(t))return t}else c.warn("packResultSet resultSet key %s does not match any model attribute",j)}}this._doPackResultSet(f,i)},f.prototype.$before=function(a){return this._filter(d.MODEL_FILTER_BEFORE,a)},f.prototype.$after=function(a){return this._filter(d.MODEL_FILTER_AFTER,a)},f.prototype.$clone=function(){},f.prototype._modelInit=function(){var a=this.beanDefinition;if(!a)return void c.error("init error no beanDefinition.");var b=this,d=a.getFunc();if(e.checkFunction(d)){var f=d.prototype;for(interface in f)e.checkFunction(f[interface])&&!function(a){return h(a)?void c.error("init error proxy method interface %j the same as ModelProxy, rename this name to another.",a):void(b[a]=function(){return b._modelInvoke(a,arguments)})}(interface)}},f.prototype._modelInvoke=function(a,b){var d=this.model;return e.checkFunction(d[a])?d[a].apply(d,b):void c.error("invoke error with %s %j",a,b)},f.prototype._doPackResultSet=function(a,b){var c=a.modelDefinition.getFields(),d=a.modelDefinition.getMid(),f=this.beanFactory;for(var g in c){var h=c[g],i=h.getRef(),j=h.getType(),k=d+"_"+g,l=b[k];if(!e.isNotNull(l)&&i){var m=f.getModelProxy(i);m&&(this._doPackResultSet(m,b),l=m)}if(e.isNotNull(l)){var n=!1;if(e.checkTypeArray(j)&&(n=!0),n){var o=a.$get(g);e.checkArray(o)||(o=[]),o.push(l),a.model[g]=o}else a.$set(g,l)}}},f.prototype._filter=function(a,b){return a!==d.MODEL_FILTER_BEFORE&&a!==d.MODEL_FILTER_AFTER?(c.warn("unknow model filter type %s",a),this):(this[a+"Flag"]=!0,e.checkString(b)&&(this[a+"Name"]=b),e.checkArray(b)&&(this[a+"Names"]=b),this)},f.prototype._getFilters=function(a){if(a===d.MODEL_FILTER_BEFORE||a===d.MODEL_FILTER_AFTER){var b=[];(a===d.MODEL_FILTER_BEFORE||a===d.MODEL_FILTER_AFTER&&!this.beforeFlag)&&this[a+"Flag"]&&b.push({type:d.FILTER_BUILTIN,method:d.FILTER_BUILTIN_METHOD});var c=this[a+"Name"];if(c){var f=this._modelInvoke(c);if(e.checkArray(f))for(var g=0;g<f.length;g++)b.push({type:d.FILTER_MODEL,method:f[g]})}for(var h=this[a+"Names"],i=0;i<h.length;i++)b.push({type:d.FILTER_MODEL,method:h[i]});return b}},f.prototype._doFilters=function(a,b,c){if(a&&a.length)for(var f,g=0;g<a.length;g++){var h=a[g],i=h.type,j=h.method;if(i===d.FILTER_BUILTIN&&(f=this.modelFilter[j](b,c),e.checkModelFilterError(f)))return f;if(i===d.FILTER_MODEL){var k=[];if(e.isNotNull(b)&&k.push(b),e.isNotNull(c)&&k.push(c),f=this._modelInvoke(j,k),e.checkModelFilterError(f))return f}}},f.prototype._result=function(a){return this._reset(d.MODEL_FILTER_BEFORE),this._reset(d.MODEL_FILTER_AFTER),a},f.prototype._reset=function(a){(a===d.MODEL_FILTER_BEFORE||a===d.MODEL_FILTER_AFTER)&&(this[a+"Flag"]=!1,this[a+"Name"]=null,this[a+"Names"]=[])},f.prototype.toJSON=function(){return this.model};var g=["_modelInit","_modelInvoke","$set","$pack","$packResultSet","_doPackResultSet","$get","$before","$after","_filter","$clone","_getFilters","_doFilters","_result","_reset","toJSON"],h=function(a){for(var b=0;b<g.length;b++)if(a===g[b])return!0;return!1};b.exports=f},{"../util/constant":37,"../util/utils":44,"pomelo-logger":57}],29:[function(a,b){var c,d=a("pomelo-logger").getLogger("bearcat","AsyncScriptLoader"),e=a("../beans/support/beanModule"),f=(a("../util/requireUtil").requirePath(),a("../util/scriptUtil")),g=a("../util/utils"),h=1;!function(){c=this}();var i=function(){this.cacheModules={},this.loaderDir=null,this.applicationContext=null};i.prototype.getLoadBeans=function(){return this.loadBeans},i.prototype.load=function(a,b){this.loaderDir=f.getLoaderDir();var c=this.loaderDir+"_load_"+h++,d=this.get(c,a);d.addEntry(d),d.setRemain(1),d.callback=function(){g.checkFunction(b)&&b(),delete d.callback,delete d.history,delete d.remain,delete d.entries},d.load()},i.prototype.save=function(a,b){var c=this.get(a);c.status<e.STATUS.SAVED&&(c.id=b.id||a,c.dependencies=b.deps||[],c.factory=b.factory,c.status=e.STATUS.SAVED)},i.prototype.module=function(a,b){var c=this.resolveDeps(b),d={id:a,uri:this.resolve(a),deps:c};d.uri?this.save(d.uri,d):e.anonymousMeta=d},i.prototype.resolve=function(a){var b=this.getPathById(a);return b||(b=a,d.warn("id: "+a+" can not be resolved, try run bearcat generate or use bearcat.module to register it")),b},i.prototype.resolveDeps=function(a){var b=a.props;if(g.isNotNull(b)&&b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=e.ref;if(f){if(this.applicationContext.getBeanDefinition(f))continue;c.push(f)}}return c}},i.prototype.getPathById=function(a){return c.__bearcatData__&&c.__bearcatData__.idPaths?c.__bearcatData__.idPaths[a]:void 0},i.prototype.get=function(a,b){return this.cacheModules[a]||(this.cacheModules[a]=new e(a,b,this))},i.prototype.setApplicationContext=function(a){this.applicationContext=a},b.exports=i},{"../beans/support/beanModule":16,"../util/requireUtil":42,"../util/scriptUtil":43,"../util/utils":44,"pomelo-logger":57}],30:[function(a,b){var c=function(){};c.prototype.load=function(b){for(var c in b){var d=b[c];a(d)}},b.exports=c},{}],31:[function(a,b){(function(c){var d=a("pomelo-logger").getLogger("bearcat","ConfigLoader"),e=a("../util/requireUtil"),f=a("../util/metaUtil"),g=a("../util/constant"),h=a("./metaLoader"),i=a("../util/utils"),j=e.requirePath(),k=function(){};b.exports=k,k.prototype.getMetaLoader=function(){return new h},k.prototype.getResources=function(a){var b=[],c={},d=this.getMetaLoader();this.getRecursiveScanPath(a,b,c);for(var e in c)d.setMetaObject(e,c[e]);for(var f=0;f<b.length;f++)d.load(b[f]);return d.getMetaObjects()},k.prototype.getRecursiveScanPath=function(a,b,e){var h=i.myRequire(a);if(h){var k=h.scan,l=h.beans,m=h.imports,n=h.namespace,o=h.dependencies,p=j.dirname(a);for(var q in o)this.getRecursiveScanPath(p+"/node_modules/"+q+"/context.json",b,e);if(i.checkArray(m))for(var r=0;r<m.length;r++)this.getRecursiveScanPath(p+"/"+m[r],b,e);if(l)for(var s=0;s<l.length;s++){var t=l[s],u=t.id;n&&(u=n+g.NAMESPACE_SEPERATOR+u);var v=null,w="";if(i.checkString(t.func)&&(w=i.getLoadPath(t.func,a),v=i.myRequire(w)),v)if(i.checkFunction(v))t.func=v;else if(i.checkObject(v)){if(!v.id||v.id!==u){d.error("meta defined in file %j %j mismatch with that defined in context %j",w,v,t);continue}t=f.mergeMeta(v,t),t.ftype="object"}if(u){var x=e[u];
e[u]=f.mergeMeta(t,x),w&&(t.fpath=j.resolve(c.cwd(),w))}}if(i.checkString(k)){var y=i.getLoadPath2(k,a);b.push(y)}if(i.checkArray(k))for(var s=0;s<k.length;s++){var y=i.getLoadPath2(k[s],a);b.push(y)}}}}).call(this,a("_process"))},{"../util/constant":37,"../util/metaUtil":39,"../util/requireUtil":42,"../util/utils":44,"./metaLoader":32,_process:51,"pomelo-logger":57}],32:[function(a,b){(function(c){var d=a("pomelo-logger").getLogger("bearcat","MetaLoader"),e=a("../util/fileUtil"),f=a("../util/metaUtil"),g=a("../util/constant"),h=a("../util/utils"),i=(a("path"),function(){this.metaObjects={}});b.exports=i,i.prototype.load=function(a){return a?(a=e.realpathSync(a),h.isDir(a)?(this.loadPath(this.metaObjects,a),this.metaObjects):void d.error("path should be directory.")):void d.error("load path should not be empty.")},i.prototype.setMetaObject=function(a,b){var c=this.metaObjects[a];this.metaObjects[a]=f.mergeMeta(b,c)},i.prototype.getMetaObjects=function(){return this.metaObjects},i.prototype.loadFile=function(a){var b=h.myRequire(a);if("off"!==c.env.BEARCAT_ANNOTATION&&h.checkFunction(b))return f.resolveFuncAnnotation(b,a);if(h.checkObject(b)&&b&&b.id&&b.func)return a&&(b.ftype="object",b.fpath=a),b},i.prototype.loadPath=function(a,b){var c=e.readdirSync(b);"/"!==b.charAt(b.length-1)&&(b+="/");for(var d,i,j,k=0,l=c.length;l>k;k++)if(i=c[k],d=b+i,h.isDir(d)&&this.loadPath(a,d),h.isFile(d)&&h.checkFileType(i,".js")&&(j=this.loadFile(d))){var m=h.getFileName(i,".js".length);if(j.id)m=j.id;else if(j.mid)m=j.mid+g.BEAN_SPECIAL_MODEL;else{if(!j.cid)continue;m=j.cid+g.BEAN_SPECIAL_CONSTRAINT}var n=a[m];a[m]=f.mergeMeta(j,n)}return a}}).call(this,a("_process"))},{"../util/constant":37,"../util/fileUtil":38,"../util/metaUtil":39,"../util/utils":44,_process:51,path:50,"pomelo-logger":57}],33:[function(a,b){var c=(a("pomelo-logger").getLogger("bearcat","PropertiesLoader"),a("../util/fileUtil")),d=a("../util/utils"),e=function(){};b.exports=e,e.prototype.loadProperties=function(a,b){var c={};return this.loadDir(c,a,!0),this.loadDir(c,a+"/"+b),c},e.prototype.loadDir=function(a,b,e){if(c.existsSync(b)&&d.isDir(b)){var f=c.readdirSync(b);"/"!==b.charAt(b.length-1)&&(b+="/");for(var g,h,i,j=0,k=f.length;k>j;j++)if(h=f[j],g=b+h,!e&&d.isDir(g)&&this.loadDir(a,g),d.isFile(g)&&d.checkFileType(g,"json")&&(i=d.myRequire(g),d.isNotNull(i)&&d.checkObject(i)))for(var l in i)d.isNotNull(i[l])&&(a[l]=i[l])}}},{"../util/fileUtil":38,"../util/utils":44,"pomelo-logger":57}],34:[function(a,b){var c=a("./configLoader"),d=function(){this.loadPathMap={},this.loadPaths=[]};b.exports=d,d.prototype.getConfigLoader=function(){var a=new c;return a},d.prototype.addLoadPath=function(a){this.loadPaths.push(a)},d.prototype.load=function(a){if(this.loadPathMap[a])return this.loadPathMap[a];var b=this.getConfigLoader().getResources(a);return this.loadPathMap[a]=b,this.addLoadPath(a),b}},{"./configLoader":31}],35:[function(a,b){var c=a("../aop/advisor"),d=a("../aop/aspect"),e=a("./utils"),f={};f.buildAspect=function(a,b){var e=new d,f=b.getBeanName();e.setBeanDefinition(b),e.setBeanName(f);for(var g=0;g<a.length;g++){var h=a[g],i=h.pointcut,j=h.advice,k=h.order,l=h.runtime||!1;if(i&&j){var m=new c;m.setPointcut(i),m.setAdvice(j),m.setBeanName(f),m.setOrder(k),m.setRuntime(l),m.parse(),e.addAdvisor(m)}}return e},f.getMethodsFromObject=function(a){var b=a,c=[];for(var d in b){var f=b[d];e.checkFunction(f)&&c.push(d)}return c},f.sortAdvisorsByOrder=function(a){return a.sort(e.compareByOrder),a},b.exports=f},{"../aop/advisor":2,"../aop/aspect":3,"./utils":44}],36:[function(a,b){var c=a("../beans/support/beanWrapper"),d=a("./utils"),e={};e.buildBeanWrapper=function(a){var b=[];if(!d.checkArray(a))return b;for(var e=0;e<a.length;e++){var f=a[e],g=new c;f.name&&g.setName(f.name),f.type&&g.setType(f.type),f.value&&g.setValue(f.value),f.ref&&g.setRef(f.ref),g.setRole(),b.push(g)}return b},e.getBeanSettingsMap=function(a){var b={};if(!d.checkArray(a))return b;for(var c=0;c<a.length;c++){var e=a[c],f=e.getName();f&&(b[f]=e)}return b},e.getBeanSettingsArray=function(a){var b=[];if(!d.isNotNull(a))return b;for(var c in a)b.push(a[c]);return b},e.sortBeanDefinitions=function(a,b){var c=[];for(var e in a){var f=a[e];!f.isSingleton()||f.isLazyInit()||f.isAbstract()||(f.hasParentBean()&&(f=b.setParentBean(f.getBeanName())),c.push(f))}return c.sort(d.compareBeans),c},b.exports=e},{"../beans/support/beanWrapper":17,"./utils":44}],37:[function(a,b){b.exports={SCOPE_DEFAULT:"singleton",SCOPE_SINGLETON:"singleton",SCOPE_PROTOTYPE:"prototype",DEPENDS_ARGS:"args",DEPENDS_PROPS:"props",SETTINGS_ARGS_ON:"argsOn",SETTINGS_PROPS_ON:"propsOn",SETTINGS_FACTORY_ARGS_ON:"factoryArgsOn",DEPEND_TYPE_BEAN:"d_bean",DEPEND_TYPE_VALUE:"d_value",DEPEND_TYPE_VAR:"d_var",DEPEND_TYPE_ERROR:"d_error",PROPS_DEFAULT:[],ARGS_DEFAULT:[],ASYNC_INIT_DEFAULT:!1,LAZY_INIT_DEFAULT:!1,ABSTRACT_DEFAULT:!1,INIT_CB_DEFAULT:function(){},AOP_ADVICE_BEFORE:"before",AOP_ADVICE_AFTER:"after",AOP_ADVICE_AROUND:"around",PROXY_DEFAULT:!0,DEFAULT_ENV:"dev",LOGPATH:"log4js.json",NAMESPACE_SEPERATOR:":",FUNC_ARGS_REGEXP:/function.*?\((.*?)\)\s*\{/,FUNC_PROPS_REGEXP:/\s*this\.\$\w+\s*=(.|\s)*?;/g,FUNC_COMMENT_LINE:/\/\/.*?\n/g,FUNC_COMMENT_STAR:/\/\*(.|\s)*?\*\//g,FUNC_ANNOTATION:"$",PROTO_FUNC_PROPS_REGEXP:/\w+\s*\$\w+\s*=(.|\s)*?;/g,META_PROPS:["id","order","init","destroy","factoryBean","factoryMethod","scope","async","abstract","parent","lazy","factoryArgs","proxy","aop","mid","table","cid","constraint","prefix"],AOP_META_PROPS:["pointcut","advice","order","runtime"],META_AOP:"aop",META_ID:"id",META_AOP_ADVICE:"advice",FILTER_BUILTIN:"builtin",FILTER_MODEL:"model",FILTER_BUILTIN_METHOD:"filter",CONSTRAINT_ANNOTATION:"$",CONSTRAINT_SPLIT:";",CONSTRAINT_METHOD:"validate",MODEL_ATTRIBUTES:["type","primary","default","ref","prefix"],MODEL_ATTRIBUTE_PRIMARY:"primary",MODEL_ATTRIBUTE_BALANCE:"balance",MODEL_ATTRIBUTE_TYPE_ARRAY:"Array",MODEL_ATTRIBUTE_TYPE_OBJECT:"Object",MODEL_FILTER_BEFORE:"before",MODEL_FILTER_AFTER:"after",BEAN_SPECIAL_MODEL:"_$model",BEAN_SPECIAL_CONSTRAINT:"_$constraint",TYPE_NUMBER:"Number",DEFINE_GETTER_PREFIX:"__"}},{}],38:[function(a,b){var c=a("fs"),d={};if(d.existsSync=function(){return!1},d.watch=function(){},d.realpathSync=function(){},d.readdirSync=function(){},c)for(var e in c)d[e]=c[e];b.exports=d},{fs:46}],39:[function(require,module,exports){(function(process){var logger=require("pomelo-logger").getLogger("Bearcat","MetaUtil"),RequireUtil=require("./requireUtil"),Constant=require("./constant"),Os=RequireUtil.requireOs(),Utils=require("./utils"),EOL=Os.EOL,MetaUtil={metaCache:{}};MetaUtil.mergeMeta=function(a,b){if(!b)return a;for(var c in a)b[c]=a[c];return b},MetaUtil.resolveFuncAnnotation=function(a,b,c){var d=a.toString();if("on"===process.env.LOADER_BIN&&(c=!0),this.metaCache[d]&&!c)return this.metaCache[d];var e=d.match(Constant.FUNC_ARGS_REGEXP);e=e?e[1]:"";var f=[];e&&(f=e.split(","));var g={},h=[],i=[],j=[],k=null;if(f.length||process.env.BEARCAT_FUNCTION_STRING)d=MetaUtil.resolveFuncComment(d),k=MetaUtil.resolvePropsFromFuncString(d,e);else try{k=new a}catch(l){return}for(var m in k)if(k.hasOwnProperty(m)||MetaUtil.checkFuncAnnotation(m)){var n=k[m];if(!Utils.checkFunction(n))if(MetaUtil.checkFuncAnnotation(m)){var o=m.substr(1);if(MetaUtil.checkInMetaProps(m))if(o===Constant.META_AOP&&k[m]===!0)g[o]=this.resolvePrototypeAnnotation(a);else{if(o===Constant.META_ID&&MetaUtil.checkInMetaProps(n,!0))return void logger.warn("bean id value must not use bearcat special bean attributes: %s",n);g[o]=n}else MetaUtil.checkInFuncArgs(m,f)||h.push(MetaUtil.checkFuncPropsValue(m)?{name:m,value:n}:MetaUtil.checkFuncPropsType(m)?{name:m,type:n}:MetaUtil.checkFuncPropsNamespace(m)?{name:m,ref:n}:{name:m,ref:o})}else MetaUtil.checkFuncPropsConfigValue(n)?h.push({name:m,value:n}):MetaUtil.checkFuncValueAnnotation(n)&&j.push({name:m,value:n})}delete k,h.length&&(g.props=h);for(var p=0;p<f.length;p++){var q=f[p].trim();if(q){var o=q.substr(1);i.push(MetaUtil.checkFuncAnnotation(q)?{name:q,ref:o}:{name:q,type:"Object"})}}i.length&&(g.args=i),j.length&&(g.attributes=j),g.func=a,b&&(g.fpath=require("path").resolve(process.cwd(),b));var r=g.id;return g.id?r=g.id:g.mid?r=g.mid+Constant.BEAN_SPECIAL_MODEL:g.cid&&(r=g.cid+Constant.BEAN_SPECIAL_CONSTRAINT),r&&(g.id=r),this.metaCache[d]=g,g},MetaUtil.resolvePropsFromFuncString=function(a,b){var c=a.match(Constant.FUNC_PROPS_REGEXP);if(c&&Utils.checkArray(c)){for(var d="var FuncProps = function("+b+") {"+EOL,e=0;e<c.length;e++)d+=c[e]+EOL;d+="}"}var f=MetaUtil.getEvalFuncProps(d);return f},MetaUtil.resolvePrototypeAnnotation=function(a){var b=a.prototype,c=[];for(var d in b){var e=b[d];if(Utils.checkFunction(e)){var f=e.toString();f=MetaUtil.resolveFuncComment(f);var g=f.match(Constant.PROTO_FUNC_PROPS_REGEXP),h="";if(g&&Utils.checkArray(g)){h="var FuncMetaProps = function() {"+EOL;for(var i=0;i<g.length;i++)h+=g[i].replace(/var\s*/,"this.")+EOL;h+="}"}var j=MetaUtil.getEvalFuncMetaProps(h),k={},l=!1;k[Constant.META_AOP_ADVICE]=d;for(var m in j)if(this.checkInAOPMetaProps(m)){var n=m.substr(1),o=j[m];k[n]=o,l=!0}l&&c.push(k)}}return c},MetaUtil.resolveFuncComment=function(a){return a=a.replace(Constant.FUNC_COMMENT_LINE,""),a=a.replace(Constant.FUNC_COMMENT_STAR,"")},MetaUtil.getEvalFuncProps=function(t){if(!t)return{};try{return eval(t),new FuncProps}catch(err){return logger.error("resolveFuncAnnotation error: "+err.stack),{}}},MetaUtil.getEvalFuncMetaProps=function(t){if(!t)return{};try{return eval(t),new FuncMetaProps}catch(err){return logger.error("resolvePrototypeAnnotation error: "+err.stack),{}}},MetaUtil.checkInMetaProps=function(a,b){var c=Constant.META_PROPS,d="";b||(d=Constant.FUNC_ANNOTATION);for(var e=0;e<c.length;e++)if(d+c[e]===a)return!0;return!1},MetaUtil.checkInAOPMetaProps=function(a){for(var b=Constant.AOP_META_PROPS,c=0;c<b.length;c++)if(Constant.FUNC_ANNOTATION+b[c]===a)return!0;return!1},MetaUtil.checkInFuncArgs=function(a,b){for(var c=0;c<b.length;c++)if(a===b[c])return!0;return!1},MetaUtil.checkFuncAnnotation=function(a){return a.match(/^\$/)},MetaUtil.checkFuncValueAnnotation=function(a){return Utils.checkString(a)?this.checkFuncAnnotation(a):!1},MetaUtil.checkFuncPropsValue=function(a){return a.match(/^\$V/)},MetaUtil.checkFuncPropsType=function(a){return a.match(/^\$T/)},MetaUtil.checkFuncPropsNamespace=function(a){return a.match(/^\$N/)},MetaUtil.checkFuncPropsConfigValue=function(a){return Utils.checkString(a)?a.match(/^\$\{.*?\}$/):void 0},MetaUtil.cleanUp=function(){this.metaCache={}},module.exports=MetaUtil}).call(this,require("_process"))},{"./constant":37,"./requireUtil":42,"./utils":44,_process:51,path:50,"pomelo-logger":57}],40:[function(a,b){var c=a("../model/modelAttribute"),d=(a("./constant"),a("./utils")),e={};e.buildModelAttribute=function(a,b){if(!d.checkArray(a))return{};for(var e={},f=[],g=!1,h="",i=0;i<a.length;i++){var j=a[i],k=j.name,l=j.value,m=new c;m.setName(k),m.setExpression(l),m.parse(l,b),e[k]=m,m.getRef()&&f.push(k);var n=m.getType();d.checkTypeArray(n)&&(g=!0),m.isBalance()&&(h=k)}return{fields:e,balance:h,refFields:f,oneToMany:g}},b.exports=e},{"../model/modelAttribute":23,"./constant":37,"./utils":44}],41:[function(a,b){var c,d=a("./utils"),e={};e.request=function(a,b,c,e){return d.checkWebWorker()?this.requestFromWebWorker(a,b,c,e):this.requestFromAsyncScript(a,b,c,e)},e.requestFromWebWorker=function(a,b){var c;try{importScripts(a)}catch(d){c=d}b(c)},e.requestFromAsyncScript=function(a,b,e,f){var g=document,h=g.head||g.getElementsByTagName("head")[0]||g.documentElement,i=h.getElementsByTagName("base")[0],j=g.createElement("script");if(e){var k=d.checkFunction(e)?e(a):e;k&&(j.charset=k)}var l=d.checkFunction(f)?f(a):f;l!==!1&&(j.crossorigin=l),this.addOnload(h,j,b,a),j.async=!0,j.src=a,c=j,i?h.insertBefore(j,i):h.appendChild(j),c=null},e.addOnload=function(a,b,c){function d(d){b.onload=b.onerror=b.onreadystatechange=null,a.removeChild(b),b=null,c(d)}var e="onload"in b;e?(b.onload=d,b.onerror=function(){d(!0)}):b.onreadystatechange=function(){/loaded|complete/.test(b.readyState)&&d()}},b.exports=e},{"./utils":44}],42:[function(a,b){var c,d=a("../../shim/builtins"),e={};!function(){c=this}(),c.process||(c.process=d.process),e.requireOs=function(){var b=a("os");return b?b:d.os},e.requirePath=function(){var b=a("path");return b?b:d.path},e.requireUtil=function(){var b=a("util");return b?b:d.util},b.exports=e},{"../../shim/builtins":55,os:49,path:50,util:53}],43:[function(a,b){var c={},d=/[^?#]*\//;c.getLoaderDir=function(){function a(a){return a.match(d)[0]}function b(a){return a.hasAttribute?a.src:a.getAttribute("src",4)}"undefined"==typeof location&&(location={});var c,e,f="undefined"==typeof window&&"undefined"!=typeof importScripts&&isFunction(importScripts),g=/^(about|blob):/,h=!location.href||g.test(location.href)?"":a(location.href);if(f){var i;try{var j=new Error;throw j}catch(k){i=k.stack.split("\n")}i.shift();for(var l,m=/.*?((?:http|https|file)(?::\/{2}[\w]+)(?:[\/|\.]?)(?:[^\s"]*)).*?/i,n=/(.*?):\d+:\d+\)?$/;i.length>0;){var o=i.shift();if(l=m.exec(o),null!=l)break}var p;if(null!=l)var p=n.exec(l[1])[1];e=p,c=a(p||h),""===h&&(h=c)}else{var q=document,r=q.scripts,s=q.getElementById("seajsnode")||r[r.length-1];e=b(s),c=a(e||h)}return c},b.exports=c},{}],44:[function(a,b){var c=a("./requireUtil"),d=a("./constant"),e=a("./fileUtil"),f=c.requirePath(),g={};g.normalizeType=function(a){if(g.checkString(a)){a=a.toLowerCase();var b=a[0].toUpperCase()+a.substr(1);return b}},g.checkTypeArray=function(a){var a=this.normalizeType(a);return a===d.MODEL_ATTRIBUTE_TYPE_ARRAY},g.checkTypeObject=function(a){var a=this.normalizeType(a);return a===d.MODEL_ATTRIBUTE_TYPE_OBJECT},g.isType=function(a){return function(b){return{}.toString.call(b)=="[object "+a+"]"}},g.checkArray=Array.isArray||g.isType("Array"),g.checkNumber=g.isType("Number"),g.checkFunction=g.isType("Function"),g.checkObject=g.isType("Object"),g.checkString=g.isType("String"),g.checkBoolean=g.isType("Boolean"),g.checkObjectEmpty=function(a){var b=!0;for(var c in a)b=!1;return b},g.checkType=function(a){return"Object"===a?!0:"Number"===a?!0:"Array"===a?!0:"Boolean"===a?!0:"Function"===a?!0:"String"===a?!0:!1},g.isNotNull=function(a){return"undefined"!=typeof a&&null!==a?!0:!1},g.myRequire=function(b){if(g.checkString(b)){var c=null;try{return c=a(b)}catch(d){return console.log(d.stack),c}}},g.myRequireHot=function(a){var b=null;try{return b=g.requireUncached(a)}catch(c){return console.log(c.stack),b}},g.getLoadPath=function(b,c){if(!g.checkString(b))return null;b=b.replace(/\./g,"/"),c=a.resolve(c);var d=f.dirname(c);return d+"/"+b},g.getLoadPath2=function(b,c){if(!g.checkString(b))return null;c=a.resolve(c);var d=f.dirname(c),e=f.resolve(d,b);return e},g.requireUncached=function(b){if(g.checkString(b)){var c=a.resolve(b);return a.cache[c]&&delete a.cache[c],a(c)}},g.checkFileType=function(a,b){if("."!==b.charAt(0)&&(b="."+b),a.length<=b.length)return!1;var c=a.substring(a.length-b.length).toLowerCase();return b=b.toLowerCase(),c===b},g.isFile=function(a){return e.existsSync(a)?e.statSync(a).isFile():void 0},g.isDir=function(a){return e.existsSync(a)?e.statSync(a).isDirectory():void 0},g.getFileName=function(a,b){var c=f.basename(a);return c.length>b?c.substring(0,c.length-b):c},g.compareByOrder=function(a,b){return a.getOrder()?b.getOrder()?a.getOrder()-b.getOrder():-1:1},g.compareBeans=function(a,b){return a.isAspect()?-1:b.isAspect()?1:a.getOrder()?b.getOrder()?a.getOrder()-b.getOrder():-1:1},g.parseArgs=function(a){var b={},c=1;b.main=a[c];for(var d=c+1;d<a.length;d++){var e=a[d],f=e.indexOf("="),g=e.slice(0,f),h=e.slice(f+1);b[g]=h}return b},g.checkBrowser=function(){return"undefined"!=typeof window},g.checkWebWorker=function(){return this.checkBrowser()&&"undefined"!=typeof importScripts&&this.checkFunction(importScripts)},g.checkModelFilterError=function(a){return a!==!0&&this.isNotNull(a)},g.checkCocos2dJsb=function(){return"undefined"!=typeof cc&&cc&&cc.sys&&cc.sys.isNative?!0:!1},b.exports=g},{"./constant":37,"./fileUtil":38,"./requireUtil":42}],45:[function(a,b){var c=a("./constant"),d=a("./utils"),e={};e.metaValidator=function(a){var b=a.id,e=a.mid,f=a.cid;if(!b&&!e&&!f)return new Error("one of id, mid, cid must be exist");if(d.isNotNull(b)&&!d.checkString(b))return new Error("id must be String");if(d.isNotNull(e)&&!d.checkString(e))return new Error("mid must be String");if(d.isNotNull(f)&&!d.checkString(f))return new Error("cid must be String");var g=a.func;if(!d.isNotNull(g)||!d.checkFunction(g))return new Error("func must be Function");var h=a.table;if(d.isNotNull(h)&&!d.checkString(h))return new Error("table must be String");var i=a.message;if(d.isNotNull(i)&&!d.checkString(i))return new Error("message must be String");var j=a.constraint;if(d.isNotNull(j)&&!d.checkString(j))return new Error("constraint must be String");var k=a.order;if(d.isNotNull(k)&&!d.checkNumber(k))return new Error("order must be Number");var l=a.parent;if(d.isNotNull(l)&&!d.checkString(l))return new Error("parent must be String");var m=a.init;if(d.isNotNull(m)&&!d.checkString(m))return new Error("init must be String");var n=a.destroy;if(d.isNotNull(n)&&!d.checkString(n))return new Error("destroy must be String");var o=a.factoryBean;if(d.isNotNull(o)&&!d.checkString(o))return new Error("factoryBean must be String");var p=a.factoryMethod;if(d.isNotNull(p)&&!d.checkString(p))return new Error("factoryMethodName must be String");var q=a.scope||c.SCOPE_DEFAULT;if(q&&q!==c.SCOPE_SINGLETON&&q!==c.SCOPE_PROTOTYPE)return new Error("scope must be singleton or prototype");var r=a.async||c.ASYNC_INIT_DEFAULT;if(d.isNotNull(r)&&!d.checkBoolean(r))return new Error("async must be Boolean");var s=a.lazy||c.LAZY_INIT_DEFAULT;return d.isNotNull(s)&&!d.checkBoolean(s)?new Error("lazy must be Boolean"):!0},b.exports=e},{"./constant":37,"./utils":44}],46:[function(){},{}],47:[function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];c.apply(this,h)}else if(f(c)){for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];for(j=c.slice(),e=j.length,i=0;e>i;i++)j[i].apply(this,h)}return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned){var e;e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d(a._events[b])?1:a._events[b].length:0}},{}],48:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],49:[function(a,b,c){c.endianness=function(){return"LE"},c.hostname=function(){return"undefined"!=typeof location?location.hostname:""},c.loadavg=function(){return[]},c.uptime=function(){return 0},c.freemem=function(){return Number.MAX_VALUE},c.totalmem=function(){return Number.MAX_VALUE},c.cpus=function(){return[]},c.type=function(){return"Browser"},c.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},c.networkInterfaces=c.getNetworkInterfaces=function(){return{}},c.arch=function(){return"javascript"},c.platform=function(){return"browser"},c.tmpdir=c.tmpDir=function(){return"/tmp"},c.EOL="\n"},{}],50:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:51}],51:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.MutationObserver,c="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};var d=[];if(b){var e=document.createElement("div"),f=new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})});return f.observe(e,{attributes:!0}),function(a){d.length||e.setAttribute("yes","no"),d.push(a)}}return c?(window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),d.length>0)){var c=d.shift();c()}},!0),function(a){d.push(a),window.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],52:[function(a,b){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],53:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":52,_process:51,inherits:48}],54:[function(a,b){b.exports={name:"bearcat",version:"0.4.19",description:"Magic, self-described javaScript objects build up elastic, maintainable front-backend javaScript applications",main:"index.js",bin:"./bin/bearcat-bin.js",scripts:{test:"grunt"},repository:{type:"git",url:"https://github.com/bearcatjs/bearcat.git"},keywords:["di","IoC","AOP","dependency","injection","consistent","configuration","hot reload","front-backend","sharable codes","dependency injection","asynchronous script loading","magic, self-described javaScript objects"],dependencies:{"pomelo-logger":"0.1.x",commander:"2.x",chokidar:"~1.0.1"},browser:{"pomelo-logger":"./shim/logger.js",chokidar:"./shim/chokidar.js"},author:"fantasyni",license:"MIT",devDependencies:{"expect.js":"~0.3.1",mocha:">=0.0.1",grunt:"~0.4.2",blanket:"1.1.x","grunt-browserify":"3.x","grunt-mocha-test":"0.8.x","grunt-contrib-clean":"0.5.x","grunt-contrib-uglify":"~0.3.2"}}
},{}],55:[function(a,b,c){c.process=a("./modules/process"),c.path=a("./modules/path"),c.util=a("./modules/util"),c.os=a("./modules/os"),a("./object")},{"./modules/os":58,"./modules/path":59,"./modules/process":60,"./modules/util":63,"./object":64}],56:[function(a,b){var c={};c.watch=function(){},b.exports=c},{}],57:[function(a,b){(function(c){function d(a){if("function"!=typeof console.log)return console;for(var b=arguments,d="",f=1;f<b.length;f++)f!==b.length-1?d=d+b[f]+"] [":d+=b[f];"string"==typeof a&&(a=a.replace(c.cwd(),""));var g=["log","debug","info","warn","error","trace"],h={};if(e.checkCocos2dJsb())for(var f=0;f<g.length;f++){var i=g[f];h[i]=cc[i]?cc[i]:cc.log}else h=console;var j={};for(var k in h)j[k]=h[k];for(var f=0;f<g.length;f++)!function(a){j[a]=function(){var e="";c.env.RAW_MESSAGE||(b.length>1&&(e="["+d+"] "),b.length&&c.env.LOGGER_LINE&&(e=getLine()+": "+e)),b.length&&(arguments[0]=e+arguments[0]),h[a].apply(h,arguments)}}(g[f]);return j}var e=a("../lib/util/utils");b.exports={getLogger:d}}).call(this,a("_process"))},{"../lib/util/utils":44,_process:51}],58:[function(a,b,c){c.endianness=function(){return"LE"},c.hostname=function(){return"undefined"!=typeof location?location.hostname:""},c.loadavg=function(){return[]},c.uptime=function(){return 0},c.freemem=function(){return Number.MAX_VALUE},c.totalmem=function(){return Number.MAX_VALUE},c.cpus=function(){return[]},c.type=function(){return"Browser"},c.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},c.networkInterfaces=c.getNetworkInterfaces=function(){return{}},c.arch=function(){return"javascript"},c.platform=function(){return"browser"},c.tmpdir=c.tmpDir=function(){return"/tmp"},c.EOL="\n"},{}],59:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:51}],60:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.MutationObserver,c="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};var d=[];if(b){var e=document.createElement("div"),f=new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})});return f.observe(e,{attributes:!0}),function(a){d.length||e.setAttribute("yes","no"),d.push(a)}}return c?(window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),d.length>0)){var c=d.shift();c()}},!0),function(a){d.push(a),window.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],61:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],62:[function(a,b){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],63:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("./support/inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/inherits":61,"./support/isBuffer":62,_process:51}],64:[function(){"function"!=typeof Object.create&&(Object.create=function(){var a=function(){};return function(b){if(arguments.length>1,"object"!=typeof b)throw TypeError("Argument must be an object");a.prototype=b;var c=new a;return a.prototype=null,c}}()),"function"!=typeof String.prototype.trim&&(String.prototype.trim||!function(){var a=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(a,"")}}())},{}]},{},[1])(1)});